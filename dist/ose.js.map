{"version":3,"file":"ose.js","sources":["../src/module/actor/sheets/character-sheet.js","../src/module/actor/sheets/monster-sheet.js","../src/ose.js"],"sourcesContent":["\n\nconst ActorSheet = foundry?.app?.ActorSheet || foundry?.appv1?.sheets?.ActorSheet;\n\nexport class OspActorSheetCharacter extends (ActorSheet || class {}) {\n  static get defaultOptions() {\n    return mergeObject(super.defaultOptions, {\n      classes: [\"osp\", \"sheet\", \"actor\", \"character\"],\n      template: \"systems/osp-houserules/templates/actors/character-sheet.html\",\n      width: 600,\n      height: 400,\n      tabs: [{ navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"description\" }],\n    });\n  }\n\n  getData() {\n    const data = super.getData();\n    return data;\n  }\n}","const ActorSheet = foundry?.app?.ActorSheet || foundry?.appv1?.sheets?.ActorSheet;\n\nexport class OspActorSheetMonster extends (ActorSheet || class {}) {\n  static get defaultOptions() {\n    return mergeObject(super.defaultOptions, {\n      classes: [\"osp\", \"sheet\", \"actor\", \"monster\"],\n      template: \"systems/osp-houserules/templates/actors/monster-sheet.html\",\n      width: 600,\n      height: 400,\n      tabs: [{ navSelector: \".sheet-tabs\", contentSelector: \".sheet-body\", initial: \"description\" }],\n    });\n  }\n\n  getData() {\n    const data = super.getData();\n    return data;\n  }\n}\n","// ose.js - Main system entry point\nconsole.log(\"OSP Debug: src/ose.js module loaded\");\n\nimport { OspActorSheetCharacter } from \"./module/actor/sheets/character-sheet.js\";\nimport { OspActorSheetMonster } from \"./module/actor/sheets/monster-sheet.js\";\n\nHooks.once(\"init\", () => {\n  console.log(\"OSP Debug: init hook – starting Actor type registration\");\n\n  // Define valid actor types\n  CONFIG.osp = CONFIG.osp || {};\n  CONFIG.osp.actorTypes = [\"character\", \"monster\"];\n\n  // Ensure typeLabels exists\n  CONFIG.Actor.typeLabels ??= {};\n  Object.assign(CONFIG.Actor.typeLabels, {\n    character: \"Character\",\n    monster: \"Monster\"\n  });\n\n  // Fallback: warn if sheetClasses is not available\n  if (!CONFIG.Actor?.sheetClasses) {\n    console.warn(\"OSP Warning: Actor sheetClasses not yet available in CONFIG. Skipping unregister step.\");\n  }\n\n  // Register OSP character sheet\n  foundry.documents.collections.Actors.registerSheet(\"osp-houserules\", OspActorSheetCharacter, {\n    types: [\"character\"],\n    label: \"Character Sheet\",\n    makeDefault: true\n  });\n\n  // Register OSP monster sheet\n  foundry.documents.collections.Actors.registerSheet(\"osp-houserules\", OspActorSheetMonster, {\n    types: [\"monster\"],\n    label: \"Monster Sheet\",\n    makeDefault: true\n  });\n\n  // Ensure default type on Actor creation if missing\n  Hooks.on(\"preCreateActor\", (data, options, userId) => {\n    if (!data.type) {\n      data.type = \"character\"; // Default fallback type\n    }\n  });\n\n  // Extend Actor Directory create button to prompt for type and name\n  Hooks.on(\"renderActorDirectory\", (_app, html, _data) => {\n    html.find('button[data-action=\"create\"]').off(\"click\").on(\"click\", async () => {\n      const content = `\n        <form>\n          <div class=\"form-group\">\n            <label>Name:</label>\n            <input type=\"text\" name=\"name\" value=\"New Actor\"/>\n          </div>\n          <div class=\"form-group\">\n            <label>Actor Type:</label>\n            <select name=\"type\">\n              <option value=\"character\">Character</option>\n              <option value=\"monster\">Monster</option>\n            </select>\n          </div>\n        </form>\n      `;\n\n      const type = await new Promise((resolve) => {\n        const dialog = new Dialog({\n          title: \"Create Actor\",\n          content,\n          buttons: {\n            create: {\n              icon: '<i class=\"fas fa-check\"></i>',\n              label: \"Create\",\n              callback: (html) => {\n                const name = html.find(\"[name=name]\").val();\n                const type = html.find(\"[name=type]\").val();\n                if (!type) {\n                  ui.notifications.error(\"You must select an Actor type.\");\n                  return resolve(null);\n                }\n                resolve({ name, type });\n              }\n            },\n            cancel: {\n              icon: '<i class=\"fas fa-times\"></i>',\n              label: \"Cancel\",\n              callback: () => resolve(null)\n            }\n          },\n          default: \"create\"\n        });\n        dialog.render(true);\n      });\n\n      if (!type) return;\n\n      await Actor.create({\n        name: type.name || \"New Actor\",\n        type: type.type\n      });\n    });\n  });\n\n  console.log(\"OSP Debug: init hook – registration complete\", CONFIG.osp.actorTypes);\n});\n"],"names":["ActorSheet"],"mappings":"AAEA,MAAMA,YAAU,GAAG,OAAO,EAAE,GAAG,EAAE,UAAU,IAAI,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,UAAU,CAAC;AAClF;AACO,MAAM,sBAAsB,UAAUA,YAAU,IAAI,MAAM,EAAE,EAAE;AACrE,EAAE,WAAW,cAAc,GAAG;AAC9B,IAAI,OAAO,WAAW,CAAC,KAAK,CAAC,cAAc,EAAE;AAC7C,MAAM,OAAO,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,WAAW,CAAC;AACrD,MAAM,QAAQ,EAAE,8DAA8D;AAC9E,MAAM,KAAK,EAAE,GAAG;AAChB,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,IAAI,EAAE,CAAC,EAAE,WAAW,EAAE,aAAa,EAAE,eAAe,EAAE,aAAa,EAAE,OAAO,EAAE,aAAa,EAAE,CAAC;AACpG,KAAK,CAAC,CAAC;AACP,GAAG;AACH;AACA,EAAE,OAAO,GAAG;AACZ,IAAI,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;AACjC,IAAI,OAAO,IAAI,CAAC;AAChB,GAAG;AACH;;ACnBA,MAAM,UAAU,GAAG,OAAO,EAAE,GAAG,EAAE,UAAU,IAAI,OAAO,EAAE,KAAK,EAAE,MAAM,EAAE,UAAU,CAAC;AAClF;AACO,MAAM,oBAAoB,UAAU,UAAU,IAAI,MAAM,EAAE,EAAE;AACnE,EAAE,WAAW,cAAc,GAAG;AAC9B,IAAI,OAAO,WAAW,CAAC,KAAK,CAAC,cAAc,EAAE;AAC7C,MAAM,OAAO,EAAE,CAAC,KAAK,EAAE,OAAO,EAAE,OAAO,EAAE,SAAS,CAAC;AACnD,MAAM,QAAQ,EAAE,4DAA4D;AAC5E,MAAM,KAAK,EAAE,GAAG;AAChB,MAAM,MAAM,EAAE,GAAG;AACjB,MAAM,IAAI,EAAE,CAAC,EAAE,WAAW,EAAE,aAAa,EAAE,eAAe,EAAE,aAAa,EAAE,OAAO,EAAE,aAAa,EAAE,CAAC;AACpG,KAAK,CAAC,CAAC;AACP,GAAG;AACH;AACA,EAAE,OAAO,GAAG;AACZ,IAAI,MAAM,IAAI,GAAG,KAAK,CAAC,OAAO,EAAE,CAAC;AACjC,IAAI,OAAO,IAAI,CAAC;AAChB,GAAG;AACH;;ACjBA;AACA,OAAO,CAAC,GAAG,CAAC,qCAAqC,CAAC,CAAC;AAInD;AACA,KAAK,CAAC,IAAI,CAAC,MAAM,EAAE,MAAM;AACzB,EAAE,OAAO,CAAC,GAAG,CAAC,yDAAyD,CAAC,CAAC;AACzE;AACA;AACA,EAAE,MAAM,CAAC,GAAG,GAAG,MAAM,CAAC,GAAG,IAAI,EAAE,CAAC;AAChC,EAAE,MAAM,CAAC,GAAG,CAAC,UAAU,GAAG,CAAC,WAAW,EAAE,SAAS,CAAC,CAAC;AACnD;AACA;AACA,EAAE,MAAM,CAAC,KAAK,CAAC,UAAU,KAAK,EAAE,CAAC;AACjC,EAAE,MAAM,CAAC,MAAM,CAAC,MAAM,CAAC,KAAK,CAAC,UAAU,EAAE;AACzC,IAAI,SAAS,EAAE,WAAW;AAC1B,IAAI,OAAO,EAAE,SAAS;AACtB,GAAG,CAAC,CAAC;AACL;AACA;AACA,EAAE,IAAI,CAAC,MAAM,CAAC,KAAK,EAAE,YAAY,EAAE;AACnC,IAAI,OAAO,CAAC,IAAI,CAAC,wFAAwF,CAAC,CAAC;AAC3G,GAAG;AACH;AACA;AACA,EAAE,OAAO,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,EAAE,sBAAsB,EAAE;AAC/F,IAAI,KAAK,EAAE,CAAC,WAAW,CAAC;AACxB,IAAI,KAAK,EAAE,iBAAiB;AAC5B,IAAI,WAAW,EAAE,IAAI;AACrB,GAAG,CAAC,CAAC;AACL;AACA;AACA,EAAE,OAAO,CAAC,SAAS,CAAC,WAAW,CAAC,MAAM,CAAC,aAAa,CAAC,gBAAgB,EAAE,oBAAoB,EAAE;AAC7F,IAAI,KAAK,EAAE,CAAC,SAAS,CAAC;AACtB,IAAI,KAAK,EAAE,eAAe;AAC1B,IAAI,WAAW,EAAE,IAAI;AACrB,GAAG,CAAC,CAAC;AACL;AACA;AACA,EAAE,KAAK,CAAC,EAAE,CAAC,gBAAgB,EAAE,CAAC,IAAI,EAAE,OAAO,EAAE,MAAM,KAAK;AACxD,IAAI,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE;AACpB,MAAM,IAAI,CAAC,IAAI,GAAG,WAAW,CAAC;AAC9B,KAAK;AACL,GAAG,CAAC,CAAC;AACL;AACA;AACA,EAAE,KAAK,CAAC,EAAE,CAAC,sBAAsB,EAAE,CAAC,IAAI,EAAE,IAAI,EAAE,KAAK,KAAK;AAC1D,IAAI,IAAI,CAAC,IAAI,CAAC,8BAA8B,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,EAAE,CAAC,OAAO,EAAE,YAAY;AACnF,MAAM,MAAM,OAAO,GAAG,CAAC;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAM,CAAC,CAAC;AACR;AACA,MAAM,MAAM,IAAI,GAAG,MAAM,IAAI,OAAO,CAAC,CAAC,OAAO,KAAK;AAClD,QAAQ,MAAM,MAAM,GAAG,IAAI,MAAM,CAAC;AAClC,UAAU,KAAK,EAAE,cAAc;AAC/B,UAAU,OAAO;AACjB,UAAU,OAAO,EAAE;AACnB,YAAY,MAAM,EAAE;AACpB,cAAc,IAAI,EAAE,8BAA8B;AAClD,cAAc,KAAK,EAAE,QAAQ;AAC7B,cAAc,QAAQ,EAAE,CAAC,IAAI,KAAK;AAClC,gBAAgB,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,GAAG,EAAE,CAAC;AAC5D,gBAAgB,MAAM,IAAI,GAAG,IAAI,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC,GAAG,EAAE,CAAC;AAC5D,gBAAgB,IAAI,CAAC,IAAI,EAAE;AAC3B,kBAAkB,EAAE,CAAC,aAAa,CAAC,KAAK,CAAC,gCAAgC,CAAC,CAAC;AAC3E,kBAAkB,OAAO,OAAO,CAAC,IAAI,CAAC,CAAC;AACvC,iBAAiB;AACjB,gBAAgB,OAAO,CAAC,EAAE,IAAI,EAAE,IAAI,EAAE,CAAC,CAAC;AACxC,eAAe;AACf,aAAa;AACb,YAAY,MAAM,EAAE;AACpB,cAAc,IAAI,EAAE,8BAA8B;AAClD,cAAc,KAAK,EAAE,QAAQ;AAC7B,cAAc,QAAQ,EAAE,MAAM,OAAO,CAAC,IAAI,CAAC;AAC3C,aAAa;AACb,WAAW;AACX,UAAU,OAAO,EAAE,QAAQ;AAC3B,SAAS,CAAC,CAAC;AACX,QAAQ,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC;AAC5B,OAAO,CAAC,CAAC;AACT;AACA,MAAM,IAAI,CAAC,IAAI,EAAE,OAAO;AACxB;AACA,MAAM,MAAM,KAAK,CAAC,MAAM,CAAC;AACzB,QAAQ,IAAI,EAAE,IAAI,CAAC,IAAI,IAAI,WAAW;AACtC,QAAQ,IAAI,EAAE,IAAI,CAAC,IAAI;AACvB,OAAO,CAAC,CAAC;AACT,KAAK,CAAC,CAAC;AACP,GAAG,CAAC,CAAC;AACL;AACA,EAAE,OAAO,CAAC,GAAG,CAAC,8CAA8C,EAAE,MAAM,CAAC,GAAG,CAAC,UAAU,CAAC,CAAC;AACrF,CAAC,CAAC"}