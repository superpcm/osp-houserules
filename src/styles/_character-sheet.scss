// ...existing code...

// Place after $cs-pos-listening-top is defined
/* Character sheet specific styles extracted from templates/actors/character-sheet.html
   Migrate presentation out of the template and into this partial. */

/* ================================================================
   COLOR VARIABLES
   ================================================================ */

/* Brand colors used throughout the character sheet */
$color-parchment: #b5ddb4 !default;  /* Main background color */
$color-wood-dark: #704214 !default;  /* Placeholder text for input fields */
$color-xp-progress: rgba(44, 24, 16, 0.2) !default;  /* XP progress bar overlay */

/* ================================================================
   DEBUG TOOLS
   ================================================================ */

/* Form Field Debug - Master Switch */
/* Set to true to enable red dashed borders on all form fields */
$debug-form-fields: false; // Change to true to enable debug mode

/* Import debug tools (position adjustment tool, form field debugging) */
@use 'character-sheet-debug' with (
  $debug-form-fields: $debug-form-fields
);

/* ========================================
   REUSABLE MIXINS
   ======================================== */

/* Flexbox centering mixin - DRY pattern for 15+ field classes */
@mixin center-flex-field {
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
}

/* Position field mixin - DRY pattern for positioning variables */
@mixin position-field($left, $top, $width, $height, $z: 15) {
  --left: #{$left};
  --top: #{$top};
  --width: #{$width};
  --height: #{$height};
  --z: var(--z-labels, #{$z});
}

/* Centralized position variables - change these to tweak sheet layout globally */
$cs-pos-level-left: 605px !default;
$cs-pos-level-top: 25px !default;
$cs-pos-portrait-left: 32px !default;
$cs-pos-portrait-top: 24px !default;
$cs-pos-languages-left: 436px !default;
$cs-pos-languages-top: 218px !default;
$cs-pos-xpmod-left: 694px !default;
$cs-pos-xpmod-top: 25px !default;
$cs-pos-xp-left: 608px !default;
$cs-pos-xp-top: 88px !default;
$cs-pos-next-left: 462px !default;
$cs-pos-next-top: 68px !default;
$cs-pos-namegroup-left: 263px !default;
$cs-pos-namegroup-top: 25px !default;
$cs-pos-class-left: 435px !default;
$cs-pos-class-top: 90px !default;
$cs-pos-alignment-left: 436px !default;
$cs-pos-alignment-top: 153px !default;
$cs-pos-race-left: 263px !default;
$cs-pos-race-top: 90px !default;
$cs-pos-age-left: 263px !default;
$cs-pos-age-top: 153px !default;
$cs-pos-sex-left: 352px !default;
$cs-pos-sex-top: 153px !default;
$cs-pos-height-left: 263px !default;
$cs-pos-height-top: 218px !default;
$cs-pos-weight-left: 350px !default;
$cs-pos-weight-top: 218px !default;
$cs-pos-background-left: 608px !default;
$cs-pos-background-top: 153px !default;
$cs-pos-listening-left: 573px !default;
$cs-pos-listening-top: 47px !default;
$cs-pos-listening-width: 72px !default;
$cs-pos-listening-height: 72px !default;
$cs-pos-find-secret-door-left: 364px !default;
$cs-pos-find-secret-door-top: 47px !default;
$cs-pos-find-secret-door-width: 72px !default;
$cs-pos-find-secret-door-height: 72px !default;
.cs-pos-find-secret-door { @include position-field($cs-pos-find-secret-door-left, $cs-pos-find-secret-door-top, $cs-pos-find-secret-door-width, $cs-pos-find-secret-door-height); }
$cs-pos-open-stuck-doors-left: 155px !default;
$cs-pos-open-stuck-doors-top: 47px !default;
$cs-pos-open-stuck-doors-width: 72px !default;
$cs-pos-open-stuck-doors-height: 72px !default;
.cs-pos-open-stuck-doors { @include position-field($cs-pos-open-stuck-doors-left, $cs-pos-open-stuck-doors-top, $cs-pos-open-stuck-doors-width, $cs-pos-open-stuck-doors-height); }
$cs-pos-detect-construction-left: 190px !default;
$cs-pos-detect-construction-top: 294px !default;
$cs-pos-detect-construction-width: 58px !default;
$cs-pos-detect-construction-height: 58px !default;
.cs-pos-detect-construction { @include position-field($cs-pos-detect-construction-left, $cs-pos-detect-construction-top, $cs-pos-detect-construction-width, $cs-pos-detect-construction-height); }
$cs-pos-detect-room-traps-left: 256px !default;
$cs-pos-detect-room-traps-top: 294px !default;
$cs-pos-detect-room-traps-width: 58px !default;
$cs-pos-detect-room-traps-height: 58px !default;
.cs-pos-detect-room-traps { @include position-field($cs-pos-detect-room-traps-left, $cs-pos-detect-room-traps-top, $cs-pos-detect-room-traps-width, $cs-pos-detect-room-traps-height); }
$cs-pos-barbarian-climb-left: 322px !default;
$cs-pos-barbarian-climb-top: 294px !default;
$cs-pos-barbarian-climb-width: 58px !default;
$cs-pos-barbarian-climb-height: 58px !default;
.cs-pos-barbarian-climb { @include position-field($cs-pos-barbarian-climb-left, $cs-pos-barbarian-climb-top, $cs-pos-barbarian-climb-width, $cs-pos-barbarian-climb-height); }
$cs-pos-barbarian-hide-left: 388px !default;
$cs-pos-barbarian-hide-top: 294px !default;
$cs-pos-barbarian-hide-width: 58px !default;
$cs-pos-barbarian-hide-height: 58px !default;
.cs-pos-barbarian-hide { @include position-field($cs-pos-barbarian-hide-left, $cs-pos-barbarian-hide-top, $cs-pos-barbarian-hide-width, $cs-pos-barbarian-hide-height); }
$cs-pos-barbarian-move-left: 454px !default;
$cs-pos-barbarian-move-top: 294px !default;
$cs-pos-barbarian-move-width: 58px !default;
$cs-pos-barbarian-move-height: 58px !default;
.cs-pos-barbarian-move { @include position-field($cs-pos-barbarian-move-left, $cs-pos-barbarian-move-top, $cs-pos-barbarian-move-width, $cs-pos-barbarian-move-height); }

// Additional skill positioning variables for dynamic skills
$cs-pos-assassination-left: 100px !default;
$cs-pos-assassination-top: 294px !default;
$cs-pos-assassination-width: 58px !default;
$cs-pos-assassination-height: 58px !default;
.cs-pos-assassination { @include position-field($cs-pos-assassination-left, $cs-pos-assassination-top, $cs-pos-assassination-width, $cs-pos-assassination-height); }

$cs-pos-climb-sheer-left: 200px !default;
$cs-pos-climb-sheer-top: 294px !default;
$cs-pos-climb-sheer-width: 58px !default;
$cs-pos-climb-sheer-height: 58px !default;
.cs-pos-climb-sheer { @include position-field($cs-pos-climb-sheer-left, $cs-pos-climb-sheer-top, $cs-pos-climb-sheer-width, $cs-pos-climb-sheer-height); }

$cs-pos-hide-shadows-left: 300px !default;
$cs-pos-hide-shadows-top: 294px !default;
$cs-pos-hide-shadows-width: 58px !default;
$cs-pos-hide-shadows-height: 58px !default;
.cs-pos-hide-shadows { @include position-field($cs-pos-hide-shadows-left, $cs-pos-hide-shadows-top, $cs-pos-hide-shadows-width, $cs-pos-hide-shadows-height); }

$cs-pos-move-silently-left: 400px !default;
$cs-pos-move-silently-top: 294px !default;
$cs-pos-move-silently-width: 58px !default;
$cs-pos-move-silently-height: 58px !default;
.cs-pos-move-silently { @include position-field($cs-pos-move-silently-left, $cs-pos-move-silently-top, $cs-pos-move-silently-width, $cs-pos-move-silently-height); }

$cs-pos-find-traps-left: 500px !default;
$cs-pos-find-traps-top: 294px !default;
$cs-pos-find-traps-width: 58px !default;
$cs-pos-find-traps-height: 58px !default;
.cs-pos-find-traps { @include position-field($cs-pos-find-traps-left, $cs-pos-find-traps-top, $cs-pos-find-traps-width, $cs-pos-find-traps-height); }

$cs-pos-open-locks-left: 150px !default;
$cs-pos-open-locks-top: 294px !default;
$cs-pos-open-locks-width: 58px !default;
$cs-pos-open-locks-height: 58px !default;
.cs-pos-open-locks { @include position-field($cs-pos-open-locks-left, $cs-pos-open-locks-top, $cs-pos-open-locks-width, $cs-pos-open-locks-height); }

$cs-pos-pick-pockets-left: 250px !default;
$cs-pos-pick-pockets-top: 294px !default;
$cs-pos-pick-pockets-width: 58px !default;
$cs-pos-pick-pockets-height: 58px !default;
.cs-pos-pick-pockets { @include position-field($cs-pos-pick-pockets-left, $cs-pos-pick-pockets-top, $cs-pos-pick-pockets-width, $cs-pos-pick-pockets-height); }

$cs-pos-hide-undergrowth-left: 350px !default;
$cs-pos-hide-undergrowth-top: 294px !default;
$cs-pos-hide-undergrowth-width: 58px !default;
$cs-pos-hide-undergrowth-height: 58px !default;
.cs-pos-hide-undergrowth { @include position-field($cs-pos-hide-undergrowth-left, $cs-pos-hide-undergrowth-top, $cs-pos-hide-undergrowth-width, $cs-pos-hide-undergrowth-height); }

$cs-pos-hide-dungeons-left: 450px !default;
$cs-pos-hide-dungeons-top: 294px !default;
$cs-pos-hide-dungeons-width: 58px !default;
$cs-pos-hide-dungeons-height: 58px !default;
.cs-pos-hide-dungeons { @include position-field($cs-pos-hide-dungeons-left, $cs-pos-hide-dungeons-top, $cs-pos-hide-dungeons-width, $cs-pos-hide-dungeons-height); }

/* ================================================================
   MASTER FONT SIZE CONTROLS
   ================================================================ */

/* Master font size for ability scores */
$cs-ability-font-size: 100px !default;

/* Master font size for saving throw targets */
$cs-save-target-font-size: 100px !default;

/* ================================================================
   MASTER DIMENSION CONTROLS
   ================================================================ */

/* Master dimensions for saving throw boxes */
$cs-save-width: 99px !default;
$cs-save-height: 98px !default;

/* Master dimensions for ability score boxes */
$cs-ability-width: 108px !default;
$cs-ability-height: 80px !default;

/* Skill Target Position Variants - Adjusts positions based on race/class layout */
/* Class-based position adjustments (take priority over race) */
.skill-layout-assassin {
  /* Base skills - all races have these */
  .cs-pos-listening { --left: #{$cs-pos-listening-left - 20px}; }
  .cs-pos-find-secret-door { --left: #{$cs-pos-find-secret-door-left - 20px}; }
  .cs-pos-open-stuck-doors { --left: #{$cs-pos-open-stuck-doors-left - 20px}; }
  
  /* Assassin-specific skills */
  .cs-pos-assassination { --left: #{$cs-pos-assassination-left - 20px}; }
  .cs-pos-climb-sheer { --left: #{$cs-pos-climb-sheer-left - 20px}; }
  .cs-pos-hide-shadows { --left: #{$cs-pos-hide-shadows-left - 20px}; }
  .cs-pos-move-silently { --left: #{$cs-pos-move-silently-left - 20px}; }
  
  /* Skills that might be present from race */
  .cs-pos-detect-construction { --left: #{$cs-pos-detect-construction-left - 20px}; }
  .cs-pos-detect-room-traps { --left: #{$cs-pos-detect-room-traps-left - 20px}; }
}

.skill-layout-barbarian {
  /* Base skills - all races have these */
  .cs-pos-listening { --left: #{$cs-pos-listening-left + 20px}; }
  .cs-pos-find-secret-door { --left: #{$cs-pos-find-secret-door-left + 20px}; }
  .cs-pos-open-stuck-doors { --left: #{$cs-pos-open-stuck-doors-left + 20px}; }
  
  /* Barbarian-specific skills */
  .cs-pos-climb-sheer { --left: #{$cs-pos-climb-sheer-left + 20px}; }
  .cs-pos-move-silently { --left: #{$cs-pos-move-silently-left + 20px}; }
  .cs-pos-hide-undergrowth { --left: #{$cs-pos-hide-undergrowth-left + 20px}; }
  
  /* Skills that might be present from race */
  .cs-pos-detect-construction { --left: #{$cs-pos-detect-construction-left + 20px}; }
  .cs-pos-detect-room-traps { --left: #{$cs-pos-detect-room-traps-left + 20px}; }
}

.skill-layout-thief {
  /* Base skills - all races have these */
  .cs-pos-listening { --left: #{$cs-pos-listening-left - 40px}; }
  .cs-pos-find-secret-door { --left: #{$cs-pos-find-secret-door-left - 40px}; }
  .cs-pos-open-stuck-doors { --left: #{$cs-pos-open-stuck-doors-left - 40px}; }
  
  /* Thief-specific skills */
  .cs-pos-climb-sheer { --left: #{$cs-pos-climb-sheer-left - 40px}; }
  .cs-pos-hide-shadows { --left: #{$cs-pos-hide-shadows-left - 40px}; }
  .cs-pos-move-silently { --left: #{$cs-pos-move-silently-left - 40px}; }
  .cs-pos-find-traps { --left: #{$cs-pos-find-traps-left - 40px}; }
  .cs-pos-open-locks { --left: #{$cs-pos-open-locks-left - 40px}; }
  .cs-pos-pick-pockets { --left: #{$cs-pos-pick-pockets-left - 40px}; }
  
  /* Skills that might be present from race */
  .cs-pos-detect-construction { --left: #{$cs-pos-detect-construction-left - 40px}; }
  .cs-pos-detect-room-traps { --left: #{$cs-pos-detect-room-traps-left - 40px}; }
}

/* Race-based position adjustments (only if no qualifying class) */
/* OLD RACE-BASED SKILL LAYOUTS REMOVED - REPLACED BY RACIAL-SKILL-LAYOUT SYSTEM */

/* COMPLEX RACE+CLASS COMBINATIONS REMOVED - REPLACED BY SIMPLIFIED RACIAL-SKILL-LAYOUT SYSTEM */

/* Generic fallback layout (default positioning when no other conditions are met) */
.skill-layout-default {
  /* Uses default positioning - ensures consistent class-based approach */
  position: relative;
}

/* Background Image Override - Apply to entire sheet and window */
form.osp.sheet.actor.character,
.osp.sheet.actor.character,
.application.window-app.sheet.actor.character.osp,
.application.window-app.sheet.actor.character.osp .window-content,
.window-content form.osp.sheet.actor.character,
.window-content .osp.sheet.actor.character,
.window-content .window-content form.osp.sheet.actor.character,
.osp .window-content {
  /*background: url('/systems/osp-houserules/assets/backgrounds/parchment1.webp') no-repeat center center !important;
  background-size: 100% !important;
  background-attachment: scroll !important;*/
  background-color: $color-parchment;
}

/* Single Background Image System - Applied to window instead of form */
form.osp.sheet.actor.character {
  position: relative;
  color: #4B4B4B !important; /* Default text color for all sheet content */
  box-sizing: border-box; /* Include padding in dimensions */
}

/* Global form element reset - remove redundant declarations */
form.osp.sheet.actor.character input,
form.osp.sheet.actor.character select,
form.osp.sheet.actor.character textarea,
form.osp.sheet.actor.character button {
  box-shadow: none !important;
  color: inherit !important;
  appearance: none !important;
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
}

/* Ensure the application window allows tabs to extend beyond right edge */
.application.window-app.sheet.actor.character.osp {
  overflow: visible !important;
}

/* Prevent accidental stacking-contexts on ancestors which can break z-index ordering */
.application.window-app.sheet.actor.character.osp,
.application.window-app.sheet.actor.character.osp .window-content,
.osp.sheet.actor.character,
.window-content,
.window-content .window-content,
.osp .window-content,
form.osp.sheet.actor.character {
  transform: none !important;
  opacity: 1 !important;
  filter: none !important;
  will-change: auto !important;
  backface-visibility: visible !important;
}

/* Window content wrapper - inherits background from main declaration above */
.application.window-app.sheet.actor.character.osp .window-content,
.osp .window-content {
  /* Background already set by main rule above */
  padding: 0 !important;
  overflow: visible !important;
}

/* Black title bar for character sheet window */
.application.window-app.sheet.actor.character.osp .window-header,
.osp .window-header {
  background: black !important;
  background-color: black !important;
  border-bottom: 1px solid #333 !important;
}

.application.window-app.sheet.actor.character.osp .window-header .window-title,
.osp .window-header .window-title { color: white !important; }
.application.window-app.sheet.actor.character.osp .window-header .header-button,
.osp .window-header .header-button { color: white !important; }
.application.window-app.sheet.actor.character.osp .window-header .header-button:hover,
.osp .window-header .header-button:hover { background: rgba(255,255,255,0.2) !important; }

/* Static header - consolidated background image and layout properties */
form.osp.sheet.actor.character .static-header,
.static-header,
.cs-static-header {
  background-color: transparent !important;
  /* Height matches the character sheet header background image exactly (286.5px) */
  /* The .5px ensures crisp alignment with the background image boundaries */
  height: 286.5px !important;
  z-index: var(--z-sheet, 10);
}

/* Header frame image as pseudo-element with higher z-index */
form.osp.sheet.actor.character .static-header::before,
.static-header::before,
.cs-static-header::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: url('/systems/osp-houserules/assets/character-sheet/basics.webp') no-repeat !important;
  background-position: left top !important;
  background-size: contain !important;
  z-index: 15 !important; /* Higher than portrait (z-index 5) to overlay it */
  pointer-events: none; /* Allow clicks to pass through */
}

/* ================================================================
   CHARACTER SHEET TAB STYLING
   ================================================================ */

/* Tab container - transparent background */
.osp.sheet.actor.character .sheet-tabs {
  background: transparent !important;  /* Override Foundry default */
  border: none !important;  /* Override Foundry default */
  margin-bottom: 0;
}

/* Tab items - match sheet parchment background */
.osp.sheet.actor.character .sheet-tabs a.item { 
  opacity: 1 !important;  /* Override Foundry default */
  background-color: $color-parchment !important;  /* Override Foundry default */
  filter: none !important;  /* Override Foundry default */
  border: 1px solid #000 !important;  /* Override Foundry default */
  position: relative;
  z-index: 10;
}

/* Tab hover state - slightly brighter */
.osp.sheet.actor.character .sheet-tabs a.item:hover { 
  filter: brightness(1.05) !important;  /* Override Foundry default */
  border-color: #000;
  z-index: 15;
}

/* Active tab - seamless connection to sheet */
.osp.sheet.actor.character .sheet-tabs a.item.active { 
  filter: none !important;  /* Override Foundry default */
  border-left: none !important;  /* Override Foundry default border */
  z-index: 20;
  margin-bottom: -1px;
}

/* Tab content area - only active tab is visible */
.sheet-body .tab.active { 
  display: block; 
}

/* Height/Weight neutralization */
.char-height, .char-weight { background: transparent !important; border: none !important; border-radius: 0 !important; outline: none !important; }
.height-group, .weight-group { background: transparent !important; border: none !important; outline: none !important; }

/* XP Award Button */
button.xp-award-btn { background: none !important; border: none !important; outline: none !important; }
button.xp-award-btn:hover, button.xp-award-btn:focus { color: #8B4513 !important; }

/* Portrait adjustment controls */
.portrait-controls { 
  position: absolute; 
  top: 100%; 
  left: 0; 
  margin-top: 5px; 
  background: rgba(0,0,0,0.95); 
  color: white; 
  padding: 3px; 
  border-radius: 3px; 
  display: none; 
  z-index: var(--z-overlay, 1000); 
  font-size: 10px; 
  white-space: nowrap; 
  border: 1px solid #666; 
  box-shadow: 0 2px 4px rgba(0,0,0,0.5); 
}

.portrait-controls[style*="display: block"] { 
  display: block !important; 
  visibility: visible !important; 
  opacity: 1 !important; 
}

.portrait-controls button { 
  background: #555; 
  color: white; 
  border: 1px solid #777; 
  padding: 2px 4px; 
  margin: 1px; 
  border-radius: 2px; 
  cursor: pointer; 
  font-size: 10px; 
  width: 18px; 
  height: 18px; 
  line-height: 14px; 
  display: inline-block; 
  text-align: center; 
  box-sizing: border-box; 
}

.portrait-controls button:hover { 
  background: #777; 
  border-color: #999; 
}

.portrait-controls button:active { 
  background: #333; 
}

.portrait-controls .btn-group { 
  display: inline-block; 
  margin: 0 2px; 
  vertical-align: top; 
}

.portrait-controls .btn-group:not(:last-child) { 
  border-right: 1px solid #777; 
  padding-right: 3px; 
}

.portrait-container.adjusting { 
  outline: 1px dashed #00aaff; 
  overflow: visible !important; 
  z-index: calc(var(--z-overlay, 1000) + 1) !important; 
}

/* Tooltip classes to replace JS-injected cssText */
.cs-tooltip { 
  position: absolute; 
  background: #333; 
  color: white; 
  padding: 8px 12px; 
  border-radius: 4px; 
  font-size: 12px; 
  line-height: 1.4; 
  z-index: var(--z-overlay, 1000); 
  pointer-events: none; 
  opacity: 0; 
  transition: opacity 0.2s; 
  white-space: nowrap;
  
  /* Auto-hide animation for stuck tooltips */
  animation: tooltip-auto-hide 3s ease-out forwards;
}

@keyframes tooltip-auto-hide {
  0% { opacity: var(--tooltip-opacity, 0); }
  20% { opacity: var(--tooltip-opacity, 0); }
  80% { opacity: var(--tooltip-opacity, 0); }
  100% { opacity: 0 !important; }
}

.cs-tooltip--xp { box-shadow: 0 2px 8px rgba(0,0,0,0.3); z-index: var(--z-top, 10000); }
.cs-tooltip--portrait { box-shadow: 0 2px 8px rgba(0,0,0,0.3); z-index: var(--z-top, 10000); }
.cs-tooltip--ability { 
  box-shadow: 0 2px 8px rgba(0,0,0,0.3); 
  z-index: var(--z-top, 10000); 
  pointer-events: none !important;
  
  /* Faster auto-hide for ability tooltips since they're more prone to sticking */
  animation: tooltip-auto-hide-fast 2s ease-out forwards;
}

@keyframes tooltip-auto-hide-fast {
  0% { opacity: var(--tooltip-opacity, 0); }
  10% { opacity: var(--tooltip-opacity, 0); }
  70% { opacity: var(--tooltip-opacity, 0); }
  100% { opacity: 0 !important; }
}

/* Dialog helper used by XP award dialog to centralize its presentation */
.cs-xp-dialog { 
  background: white !important; 
}

.cs-xp-dialog .window-header { 
  background: black !important; 
  color: white !important; 
}

.cs-xp-dialog .window-content { 
  background: white !important; 
}

/* Dialog layout and control helpers for handler-generated markup */
.cs-xp-dialog-container { 
  padding: 10px; 
}

.cs-xp-row { 
  margin-bottom: 20px; 
  text-align: center; 
}

.cs-xp-inline { 
  margin-bottom: 10px; 
  display: flex; 
  align-items: center; 
  gap: 8px; 
  justify-content: center; 
}

.cs-xp-flex { 
  display: flex; 
  gap: 20px; 
}

.cs-xp-col { 
  flex: 1; 
}

.cs-input-small { 
  width: 60px; 
  padding: 5px; 
  background-color: white; 
  border: 1px solid black; 
  border-radius: 9px; 
  text-align: center; 
}

.cs-input-medium { 
  width: 80px; 
  padding: 5px; 
  background-color: white; 
  border: 1px solid black; 
  border-radius: 9px; 
  text-align: center; 
}

.cs-no-border { 
  border: none; 
  background: none; 
  color: inherit; 
  padding: 0; 
}

.cs-xp-preview { 
  margin-top: 15px; 
  padding: 8px; 
  background: #f5f5f5; 
  border-radius: 3px; 
  display: none; 
}

/* XP dialog side column helpers (replaces small inline wrappers) */
.cs-xp-side { 
  flex: 1; 
  display: flex; 
  flex-direction: column; 
  justify-content: center; 
}

.cs-xp-side-row { 
  margin-bottom: 10px; 
  display: flex; 
  align-items: center; 
  gap: 8px; 
  justify-content: center; 
}

/* Reusable small select style for inline dialogs (appearance reset handled elsewhere) */
.cs-select-inline { 
  width: 60px; 
  padding: 5px; 
  background-color: white; 
  border: 1px solid black; 
  border-radius: 9px; 
  text-align: center; 
  line-height: 1.2; 
  appearance: none; 
  -webkit-appearance: none; 
  -moz-appearance: none; 
}

/* Language dialog helpers */
.cs-dialog-row { 
  margin-bottom: 8px; 
}

.cs-dialog-columns { 
  display: flex; 
  gap: 40px; 
}

.cs-dialog-column { 
  display: flex; 
  flex-direction: column; 
  align-items: flex-start; 
  gap: 6px; 
}

.cs-custom-input { 
  width: 145px; 
}

.cs-dialog-label { 
  display: flex; 
  align-items: center; 
  gap: 8px; 
}

/* Level & portrait container utility classes (migrate inline box-shadow/positioning into class-based rules) */
.cs-level-container { 
  position: absolute; 
  width: 64px; 
  height: 34px; 
}

.cs-level-shadow { 
  position: absolute; 
  top: 0; 
  left: 0; 
  width: 64px; 
  height: 34px; 
  z-index: var(--z-labels, 15); 
  pointer-events: none; 
  border-radius: 6px; 
}

/* Combat and ability layouts markup helpers */
.cs-combat-stats { 
  display: flex; 
  gap: 1.5rem; 
  justify-content: center; 
  margin-bottom: 2rem; 
  flex-wrap: wrap; 
}

.cs-combat-stat { 
  display: flex; 
  flex-direction: column; 
  align-items: center; 
}
.cs-save-badge { 
  border: none !important; 
  border-radius: 0 !important; 
  background-color: transparent !important; 
  position: relative; 
  width: 100% !important; 
  height: 100% !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
}

/* Ability score box */
.cs-ability-select {
  @include center-flex-field;
  font-variant-numeric: tabular-nums;
  
  /* Remove explicit dimensions - let container (.cs-ability) handle sizing */
  width: 100%;
  height: 100%;
  font-size: $cs-ability-font-size;
  font-weight: normal;
  border: none !important;
  background: transparent !important;
  position: relative; /* Ensure proper positioning context */
  z-index: var(--z-labels, 15); /* Ensure tooltips work properly */
  pointer-events: auto; /* Ensure mouse events work */
  line-height: 1;
  transform: translateY(-0.1em); /* Vertical centering adjustment for select elements */
}

/* NOTE: Old .cs-ability positioning removed - now uses simplified system at bottom of file */

/* Hide tooltips when dropdown is active/focused */
.cs-ability-select:focus ~ .cs-tooltip,
.cs-ability-select:active ~ .cs-tooltip,
.cs-ability-select:focus-within ~ .cs-tooltip {
  opacity: 0 !important;
  visibility: hidden !important;
  animation: none !important;
}

/* Hide tooltips when any dropdown in the ability section is open */
.ability-scores-section:focus-within .cs-tooltip {
  opacity: 0 !important;
  visibility: hidden !important;
  animation: none !important;
}

/* ================================================================
   SIMPLIFIED POSITIONING SYSTEM
   ================================================================
   Group-based positioning with individual field overrides.
   Positioning tool uses --left, --top, --width, --height for overrides.
   
   Variable Priority (CSS Cascade):
   1. --left, --top, --width, --height (positioning tool - highest priority)
   2. --field-left, --group-top, --field-width, --field-height (field defaults)
   3. Hardcoded fallback values (lowest priority)
   ================================================================ */

/* Group Defaults - Shared coordinates for field groups */
:root {
  --ability-group-top: 39px;
  --ability-group-width: #{$cs-ability-width};
  --ability-group-height: #{$cs-ability-height};
  --save-group-top: 216px;
  --save-group-width: #{$cs-save-width};
  --save-group-height: #{$cs-save-height};
}

/* Ability Group Positioning - Individual X coordinates */
.ability:has(.attr-str) { --field-left: 32px; }
.ability:has(.attr-int) { --field-left: 158px; }
.ability:has(.attr-wis) { --field-left: 284px; }
.ability:has(.attr-dex) { --field-left: 410px; }
.ability:has(.attr-con) { --field-left: 536px; }
.ability:has(.attr-cha) { --field-left: 662px; }

/* Listening at Doors field styling */
.listening-group {
  z-index: var(--z-labels, 15);
  pointer-events: auto;
}

/* Hide Barbarian skill fields by default - JavaScript will show them when needed */
.cs-pos-barbarian-climb,
.cs-pos-barbarian-hide,
.cs-pos-barbarian-move {
  display: none;
}

.listening-group .cs-field-label {
  display: none !important;
}

.cs-listening-select {
  @include center-flex-field;
  
  width: 72px;
  height: 72px;
  font-size: 100px;
  /* Compressed line-height (0.5) centers large font visually within the 72px box */
  /* At 100px font-size with line-height 0.5, the line box shrinks to 50px, */
  /* allowing proper vertical centering of the glyph within the container */
  line-height: 0.5;
  background-color: transparent !important;  /* Override browser defaults */

  margin: 0;
  padding: 0;  /* Ensure no padding reduces available space */
  border: none !important;  /* Override browser defaults */
  pointer-events: auto;
  overflow: visible;  /* Allow text to render fully */
  
  /* Force horizontal centering - remove browser defaults */
  text-indent: 0;
  padding-left: 5px;
  padding-right: 0;
  box-sizing: border-box;
  
  /* Remove dropdown arrow to prevent offset */
  appearance: none !important;  /* Browser default override necessary */
  -webkit-appearance: none !important;
  -moz-appearance: none !important;
}

.cs-listening-select option {
  text-align: center;  /* Center options in dropdown too */
}

/* Tabs helper (in case nav items had inline styles) */
.cs-tabs { display: flex; flex-direction: column; }
.cs-tab-item { 
  opacity: 1 !important; 
  background: rgba(139, 123, 101, 0.4) !important; /* Semi-transparent to show parchment */
  
}

/* Tabs runtime helpers */
.cs-tabs {
  position: relative !important;
  z-index: var(--z-top, 10000) !important;
  pointer-events: auto !important;
  top: var(--tabs-top, 3px);
}
.cs-tab-item {
  position: relative !important;
  z-index: 10 !important; /* Base tab layer */
  pointer-events: auto !important;
  cursor: pointer !important;
}

/* Active tab state for cs-tab-item */
.cs-tab-item.active {
  z-index: 20 !important; /* Active tab comes forward */
  border-left: none !important; /* Seamless connection to page */
  background: rgba(255, 255, 255, 0.8) !important; /* More opaque for active tab */
}

/* Hover state for cs-tab-item */
.cs-tab-item:hover {
  z-index: 15 !important; /* Hover tab comes slightly forward */
  background: rgba(139, 123, 101, 0.6) !important; /* Slightly more opaque on hover */
}
.cs-force-pointer { pointer-events: auto !important; }

/* Cursor helper classes for JS toggles */
.cs-cursor-pointer { cursor: pointer !important; }
.cs-cursor-text { cursor: text !important; }

/* Combat input boxes */
.cs-combat-input {
  @include center-flex-field;
  font-variant-numeric: tabular-nums;
  
  width: 80px;
  height: 40px;
  border: 2px solid #4a5568;
  border-radius: 8px;
  background-color: white;
}

/* Combat tab background - Base layers for all layouts */
.tab[data-tab="combat"] {
  position: relative;
  background-image: url('/systems/osp-houserules/assets/character-sheet/abilities-saves.webp') !important;
  background-size: contain, contain !important;
  /* background-position: center top, left 282.75px !important; */
  background-repeat: no-repeat, no-repeat !important;
  background-attachment: scroll, scroll !important;
  background-color: transparent !important;
  height: 360px !important;
}

/* Combat Tab Styles */
.tab[data-tab="combat-tab"] {
  position: relative;
  background-color: transparent;
  padding: 0px;
  height: 400px;
  
  .combat-content {
    padding: 20px;
    text-align: center;
    font-size: 16px;
    color: #2c1810;
  }
  
  /* Combat Stats in Combat Tab */
  .combat-stats {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    justify-content: center;
    margin-top: 20px;
    
    .combat-stat {
      display: flex;
      flex-direction: column;
      align-items: center;
      min-width: 120px;
      
      .cs-field-label {
        font-size: 14px;
        font-weight: bold;
        margin-bottom: 5px;
        color: #2c1810;
        text-align: center;
      }
      
      .cs-combat-input {
        width: 80px;
        height: 40px;
        text-align: center;
        font-size: 16px;
        border: 2px solid #8b4513;
        border-radius: 4px;
        background-color: rgba(240, 228, 188, 0.8);
        color: #2c1810;
        
        &:focus {
          outline: none;
          border-color: #654321;
          background-color: rgba(240, 228, 188, 1);
        }
      }
      
      .cs-unarmored-box {
        width: 80px;
        height: 40px;
        text-align: center;
        font-size: 16px;
        border: 2px solid #8b4513;
        border-radius: 4px;
        display: flex;
        align-items: center;
        justify-content: center;
        background-color: rgba(240, 228, 188, 0.6);
        color: #2c1810;
        font-weight: bold;
      }
    }
  }
}

/* Race-based variants (only applied if no qualifying class) */
/* OLD RACE-BASED SKILL LAYOUT BACKGROUND IMAGES REMOVED - REPLACED BY RACIAL-SKILL-LAYOUT SYSTEM */

.cs-unarmored-box { 
  width: 80px; 
  height: 40px; 
  text-align: center; 
  font-size: 1.2rem; 
  border: 2px solid #4a5568; 
  border-radius: 8px; 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  background-color: white; 
}

/* OLD RACIAL-SKILL-TARGETS SYSTEM REMOVED - REPLACED BY RACIAL-SKILL-LAYOUT SYSTEM */

/* ========================================
   RACIAL SKILL LAYOUT SYSTEM 
   Clean separation for 3 scenarios: Default, Dwarf, Gnome
   ======================================== */

/* Shared base positioning variables for racial skills */
$racial-skill-top: 47px !default;  /* Master Y position for all racial skills */

/* Shared properties mixin - eliminates repetition */
@mixin racial-skill-base($left-position) {
  --left: #{$left-position};
  --top: #{$racial-skill-top};
}

/* Shared background mixin - eliminates repetition */
@mixin racial-skill-background($image-name) {
  .tab[data-tab="skills"] {
    background-image: url('/systems/osp-houserules/assets/character-sheet/#{$image-name}.webp');
    background-size: contain;
    background-position: center top;
    background-repeat: no-repeat;
    background-attachment: scroll;
  }
}

/* ========================================
   Default Layout (3 base skills only)
   ======================================== */
.racial-skill-layout-default {
  /* Uses default variable positions */
  .cs-pos-listening { 
    @include racial-skill-base($cs-pos-listening-left);
    --width: #{$cs-pos-listening-width}; 
    --height: #{$cs-pos-listening-height}; 
  }
  .cs-pos-find-secret-door { 
    @include racial-skill-base($cs-pos-find-secret-door-left);
    --width: #{$cs-pos-find-secret-door-width}; 
    --height: #{$cs-pos-find-secret-door-height}; 
  }
  .cs-pos-open-stuck-doors { 
    @include racial-skill-base($cs-pos-open-stuck-doors-left);
    --width: #{$cs-pos-open-stuck-doors-width}; 
    --height: #{$cs-pos-open-stuck-doors-height}; 
  }
  
  @include racial-skill-background('racial-skill-targets-default');
}

/* ========================================
   Dwarf Layout (5 skills: base 3 + 2 racial)
   ======================================== */
.racial-skill-layout-dwarf {
  /* Base skills with dwarf-specific horizontal positions */
  .cs-pos-listening { 
    @include racial-skill-base(268px);
    --width: #{$cs-pos-listening-width}; 
    --height: #{$cs-pos-listening-height}; 
  }
  .cs-pos-find-secret-door { 
    @include racial-skill-base(143px);
    --width: #{$cs-pos-find-secret-door-width}; 
    --height: #{$cs-pos-find-secret-door-height}; 
  }
  .cs-pos-open-stuck-doors { 
    @include racial-skill-base(19px);
    --width: #{$cs-pos-open-stuck-doors-width}; 
    --height: #{$cs-pos-open-stuck-doors-height}; 
  }
  
  /* Dwarf-only racial skills */
  .cs-pos-detect-construction { 
    @include racial-skill-base(392px);
    --width: #{$cs-pos-detect-construction-width}; 
    --height: #{$cs-pos-detect-construction-height}; 
  }
  .cs-pos-detect-room-traps { 
    @include racial-skill-base(516px);
    --width: #{$cs-pos-detect-room-traps-width}; 
    --height: #{$cs-pos-detect-room-traps-height}; 
  }
  
  @include racial-skill-background('racial-skill-targets-dwarf');
}

/* ========================================
   Gnome Layout (4 skills: base 3 + 1 racial)
   ======================================== */
.racial-skill-layout-gnome {
  /* Base skills with gnome-specific horizontal positions */
  .cs-pos-listening { 
    @include racial-skill-base(342px);
    --width: #{$cs-pos-listening-width}; 
    --height: #{$cs-pos-listening-height}; 
  }
  .cs-pos-find-secret-door { 
    @include racial-skill-base(193px);
    --width: #{$cs-pos-find-secret-door-width}; 
    --height: #{$cs-pos-find-secret-door-height}; 
  }
  .cs-pos-open-stuck-doors { 
    @include racial-skill-base(45px);
    --width: #{$cs-pos-open-stuck-doors-width}; 
    --height: #{$cs-pos-open-stuck-doors-height}; 
  }
  
  /* Gnome-only racial skill */
  .cs-pos-detect-construction { 
    @include racial-skill-base(491px);
    --width: #{$cs-pos-detect-construction-width}; 
    --height: #{$cs-pos-detect-construction-height}; 
  }
  
  @include racial-skill-background('racial-skill-targets-gnome');
}

/* Save badge system */
.combat-section {
  position: relative;
  width: 100%;
}

/* Universal absolute positioning for all positioned elements */
.cs-abs {
  position: absolute !important;
  /* Use consistent variable cascade that matches specific positioning systems */
  left: var(--left, var(--field-left, auto)) !important;
  top: var(--top, var(--group-top, auto)) !important;
  width: var(--width, var(--field-width, auto)) !important;
  height: var(--height, var(--field-height, auto)) !important;
  z-index: var(--z, 2) !important;
}

/* Simplified: No override rules needed - positioning tool variables integrated directly */

/* Save Group Positioning - Individual X coordinates */
.save-group-death { --field-left: 52px; }
.save-group-wands { --field-left: 201px; }
.save-group-paralysis { --field-left: 350px; }
.save-group-breath { --field-left: 499px; }
.save-group-spells { --field-left: 648px; }
.cs-save-value {
  text-align: center;
  line-height: 1;
  font-size: $cs-save-target-font-size !important;
}

/* Misc helpers for textareas in bio */
.cs-bio-textarea { 
  width: 100%; 
  padding: 0.5rem; 
  border: 1px solid #ccc; 
  border-radius: 3px; 
  resize: vertical; 
  font-family: inherit; 
  background-color: white; 
}

/* Encumbrance bar helpers */
.encumbrance-section .encumbrance-bar-container { 
  position: relative; 
}

.encumbrance-section .encumbrance-bar { 
  height: 12px; 
  background: #22c55e; 
  transition: width 0.3s ease; 
  width: var(--encumbrance-width, 0%); 
}

/* Level progress helpers */
.cs-level-display {
  @include center-flex-field;
  box-sizing: border-box;
  width: 73px;
  height: 39px;
  font-size: 36px;
  z-index: var(--z-level, -10);
  background: transparent !important;
  padding: 0 0 2px 0;
}

/* Portrait helpers - configurable dimensions via CSS variables */
.cs-portrait-container { 
  position: absolute; 
  width: var(--width, 214px) !important; /* Use CSS variable with fallback */
  height: var(--height, 249px) !important; /* Use CSS variable with fallback */
  overflow: hidden; 
  z-index: 5 !important; /* Force portrait above header frame */
  --z: 5; /* Set CSS variable for .cs-abs compatibility */
}
.cs-portrait-display,
.portrait-display { 
  position: absolute; 
  top: 0; 
  left: 0; 
  width: 100%; 
  height: 100%; 
  cursor: pointer; 
  border-radius: 1px; 
  overflow: hidden; 
  pointer-events: auto; 
  z-index: 20 !important; /* Force above header frame */
}
.cs-portrait-img,
.portrait-img { 
  /* Default size: fit within container while maintaining aspect ratio */
  max-width: 100%;
  max-height: 100%;
  width: auto;
  height: auto;
  display: block; 
  /* Player can resize and reposition from this starting size */
  transform: scale(var(--user-portrait-scale, 1)) translate(var(--user-portrait-x, 0px), var(--user-portrait-y, 0px));
  transform-origin: center center;
  transition: transform 0.2s ease;
}

/* XP/Next level small field helpers */
.cs-field {
  @include center-flex-field;
  
  background-color: transparent !important;
  border: none;

  margin: 0;
  color: inherit;
  padding: 0 2px 0 2px;
}

.cs-xp-mod-display {
  @include center-flex-field;
  font-variant-numeric: tabular-nums;
  
  width: 74px;
  height: 39px;
  pointer-events: none;
  font-size: 36px;
}

.cs-xp-display {
  @include center-flex-field;
  font-variant-numeric: tabular-nums;
  
  width: 160px;
  height: 41px;
  cursor: pointer;
  pointer-events: auto;
  font-size: 36px;
}

/* ================================================================
   SIMPLIFIED VISUAL CENTERING
   ================================================================ */

/* Modern CSS centering - no complex placeholders needed */

/* Basic input styling - simplified centering */
input[type="text"], 
input[type="number"], 
select {
  text-align: center;
  
  /* Remove number input spinners for cleaner appearance */
  &::-webkit-outer-spin-button,
  &::-webkit-inner-spin-button {
    -webkit-appearance: none;
    appearance: none;
    margin: 0;
  }
}

input[type="number"] {
  -moz-appearance: textfield;
  appearance: textfield;
}

/* Header field classes (name, class, race, small fields) */
.cs-char-name {
  @include center-flex-field;
  
  width: 332px;
  height: 39px;
  font-size: 36px;
  background-color: transparent !important;
  white-space: nowrap;
  text-overflow: clip;
  border: none;
  padding: 0 2px 0 2px;
}

.cs-class-select {
  /* Removed conflicting @extend mixins - using manual centering instead */
  @include center-flex-field;
  box-sizing: border-box;
  
  width: 160px;
  height: 39px;
  font-size: 36px;
  background-color: transparent !important;

  margin: 0;
  border: none;
  pointer-events: auto;
  padding: 0 2px 0 2px;
}

/* Background field - separate class for independent control */
.cs-background-select {
  @include center-flex-field;
  line-height: 1;
  box-sizing: border-box;
  width: 160px;
  height: 39px;
  font-size: var(--background-font-size, 36px);
  font-weight: normal;
  letter-spacing: 0;
  background-color: transparent !important;
  border: none;
  margin: 0;
  padding: 0 5px 0 5px;
  pointer-events: auto;
  cursor: pointer;
  vertical-align: middle;
  white-space: nowrap;
  text-overflow: clip;
  overflow: visible;
  &:focus {
    outline: none;
  }
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
  }
}

/* Race field - separate class for independent control */
.cs-race-select {
  /* Inherit base layout from large selects but allow independent styling */
  @include center-flex-field;
  box-sizing: border-box;
  
  /* Size and positioning */
  width: 159px;
  height: 39px;
  
  /* Typography - customize as needed */
  font-size: 36px;
  font-weight: normal;
  letter-spacing: 0;
  
  /* Appearance */
  background-color: transparent !important;
  color: inherit;
  border: none;

  /* Layout */
  margin: 0;
  padding: 0 5px 2px 5px;
  
  /* Interaction */
  pointer-events: auto;
  cursor: pointer;
  
  /* Focus states - customize as needed */
  &:focus {
    outline: none;
  }
  
  /* Disabled states (for race-as-class synchronization) */
  &:disabled {
    opacity: 0.6;
    cursor: not-allowed;
    background-color: rgba(0, 0, 0, 0.05) !important;
  }
}

/* XP container with XP progress bar */
.xp-group {
  position: relative;
  width: 131px;
  height: 41px;  /* Match progress bar height for consistency */
  
  /* XP Progress bar within XP field */
  .level-xp-progress {
    position: absolute;
    top: 0px;
    left: 0px;
    height: 100%;  /* Use parent height */
    width: var(--xp-progress-width, 0%);  /* Dynamically updated by JavaScript */
    background: $color-xp-progress;  /* Solid color - change variable to adjust progress bar color */
    transition: width 0.3s ease;
    z-index: 1;
    border-radius: 3px;
    overflow: hidden;
  }
  
  /* XP display sits on top of progress bar */
  .cs-xp-display {
    position: relative;
    z-index: 2;
  }
}

/* Alignment field - separate class for independent control */
.cs-alignment-select {
  @include center-flex-field;
  box-sizing: border-box;
  width: 159px;
  height: 39px;
  font-size: 36px;
  background-color: transparent !important;
  color: inherit;
  border: none;
  padding: 0 5px 0 5px;
  pointer-events: auto;
  cursor: pointer;

  &:focus {
    outline: none;
  }
}

/* Height field - separate class for independent control */
.cs-height-field {
  @include center-flex-field;
  box-sizing: border-box;
  width: 74px;
  height: 39px;
  font-size: 36px;
  letter-spacing: 0;
  background-color: transparent !important;
  color: inherit;
  border: none;
  margin: 0;
  padding: 0 2px 0 2px;
  pointer-events: auto;
  cursor: text;
  vertical-align: middle;
  &:focus {
    outline: none;
  }
  &::placeholder {
    color: $color-wood-dark;
    font-style: italic;
  }
}

/* Weight field - separate class for independent control */
.cs-weight-field {
  @include center-flex-field;
  line-height: 1;
  box-sizing: border-box;
  width: 73px;
  height: 39px;
  font-size: 36px;
  letter-spacing: 0;
  background-color: transparent !important;
  color: inherit;
  border: none;
  margin: 0;
  padding: 0;
  pointer-events: auto;
  cursor: text;
  vertical-align: middle;
  &:focus {
    outline: none;
  }
  &::placeholder {
    color: $color-wood-dark;
    font-style: italic;
  }
}

/* Languages field - separate class for independent control */
.cs-languages-field {
  @include center-flex-field;
  box-sizing: border-box;
  width: 331px;
  height: 39px;
  font-size: var(--languages-font-size, 36px);
  font-weight: normal;
  letter-spacing: var(--languages-letter-spacing, 0px);
  line-height: var(--languages-line-height, 1);
  background: transparent !important;
  border: none !important;
  margin: 0;
  padding: 2px 3px 2px 3px;
  pointer-events: auto;
  cursor: pointer;
  user-select: none;
  vertical-align: middle;
}

/* Age field - separate class for independent control */
.cs-age-field {
  @include center-flex-field;
  box-sizing: border-box;
  width: 74px;
  height: 40px;
  font-size: 36px;
  background-color: transparent !important;
  border: none;
  vertical-align: middle;
}

/* Sex field - separate class for independent control */
.cs-sex-field {
  @include center-flex-field;
  box-sizing: border-box;
  width: 73px;
  height: 39px;
  font-size: 36px;
  background-color: transparent !important;
  border: none;
  cursor: pointer;
  vertical-align: middle;
  option {
    font-size: 16px;
    color: $color-wood-dark;
    background-color: #ffffff;
  }
}

/* Keep this partial focused on presentation only; behavior remains in JS. */

/* Note: .cs-abs positioning now handled by the unified system above */



/* Sheet body helper to centralize padding/scrolling */
.cs-sheet-body {
  position: absolute !important;
  top: var(--sheet-top, 298px);
  left: 0;
  right: 0;
  bottom: 0;
  /* padding: 0 19px 0px 19px; */
  /* overflow-y: auto; */
}

/* Generic small field label */
.cs-field-label { margin-bottom: 0.5rem; font-size: 1.1rem; }

/* Languages row and tags reset for consistent layout */
.languages-row.open-language-dialog { width: var(--languages-row-width, 272px); height: 33px; min-height: 30px; cursor: pointer; display: flex; align-items: center; justify-content: center; padding: 2px; z-index: var(--z-lang-row, 101); }
.languages-tags { 
  display: flex; 
  align-items: center; 
  justify-content: center; 
  width: 100%; 
  line-height: 0.6;
  white-space: wrap; /* Allow wrapping when needed */
  overflow: hidden; 
  font-size: var(--languages-font-size, 34px) !important;
  padding: 0 4px;


  text-align: center;
  word-wrap: break-word; /* Allow breaking long words if needed */
  
  /* When not empty, ensure our font size applies - higher specificity */
  &:not(:empty) {
    font-size: var(--languages-font-size, 34px) !important;
  }
}

/* Bio content wrapper */
.bio-content { padding: 1rem; display: flex; flex-direction: column; gap: 1rem; }

/* Position presets (centralize numeric offsets) */
.cs-pos-level { --left: #{$cs-pos-level-left}; --top: #{$cs-pos-level-top}; --z: var(--z-level, 8); }
.cs-pos-portrait { --left: #{$cs-pos-portrait-left}; --top: #{$cs-pos-portrait-top}; --z: 5; }
.cs-pos-languages { --left: #{$cs-pos-languages-left}; --top: #{$cs-pos-languages-top}; --z: var(--z-labels, 15); --pointer: auto; }
.cs-pos-xpmod { --left: #{$cs-pos-xpmod-left}; --top: #{$cs-pos-xpmod-top}; --z: var(--z-labels, 15); }
.cs-pos-xp { --left: #{$cs-pos-xp-left}; --top: #{$cs-pos-xp-top}; --z: var(--z-portrait, 15); }
.cs-pos-next { --left: #{$cs-pos-next-left}; --top: #{$cs-pos-next-top}; --z: var(--z-labels, 15); }
.cs-pos-sep { --bottom: 0; --left: 0; --right: 0; --height: 1px; --bg: transparent; --z: var(--z-labels, 15); }

/* Header / small-field presets discovered during the sweep */
.cs-pos-namegroup { --left: #{$cs-pos-namegroup-left}; --top: #{$cs-pos-namegroup-top}; --z: var(--z-labels, 15); }
.cs-pos-class { --left: #{$cs-pos-class-left}; --top: #{$cs-pos-class-top}; --z: var(--z-labels, 15); }
.cs-pos-alignment { --left: #{$cs-pos-alignment-left}; --top: #{$cs-pos-alignment-top}; --z: var(--z-labels, 15); }
.cs-pos-race { --left: #{$cs-pos-race-left}; --top: #{$cs-pos-race-top}; --z: var(--z-labels, 15); }
.cs-pos-age { --left: #{$cs-pos-age-left}; --top: #{$cs-pos-age-top}; --z: var(--z-labels, 15); }
.cs-pos-sex { --left: #{$cs-pos-sex-left}; --top: #{$cs-pos-sex-top}; --z: var(--z-labels, 15); }
.cs-pos-height { --left: #{$cs-pos-height-left}; --top: #{$cs-pos-height-top}; --z: var(--z-labels, 15); }
.cs-pos-weight { --left: #{$cs-pos-weight-left}; --top: #{$cs-pos-weight-top}; --z: var(--z-labels, 15); }
.cs-pos-background { --left: #{$cs-pos-background-left}; --top: #{$cs-pos-background-top}; --z: var(--z-labels, 15); }
.cs-pos-listening { --left: #{$cs-pos-listening-left}; --top: #{$cs-pos-listening-top}; --width: #{$cs-pos-listening-width}; --height: #{$cs-pos-listening-height}; --z: var(--z-labels, 15); }

/* Universal Save Positioning - Simplified System with Tool Integration */
.cs-save {
  position: absolute !important;
  /* Positioning tool variables take precedence, then field defaults, then group defaults */
  left: var(--left, var(--field-left, 0px)) !important;
  top: var(--top, var(--group-top, var(--save-group-top))) !important;
  width: var(--width, var(--field-width, var(--save-group-width))) !important;
  height: var(--height, var(--field-height, var(--save-group-height))) !important;
  z-index: var(--z-labels, 15) !important;
}

/* Universal Ability Positioning - Simplified System with Tool Integration */
.cs-ability {

  /* Positioning tool variables take precedence, then field defaults, then group defaults */
  left: var(--left, var(--field-left, 504px)) !important;
  top: var(--top, var(--group-top, var(--ability-group-top))) !important;
  width: var(--width, var(--field-width, var(--ability-group-width))) !important;
  height: var(--height, var(--field-height, var(--ability-group-height))) !important;
  z-index: var(--z-labels, 15) !important;
  pointer-events: auto !important;
}

/* Small helpers found useful during migration */
.cs-tab-relative { position: relative; }
.cs-bio-heading { margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em; }

/* ============================
   SKILLS TAB BACKGROUND SYSTEM
   ============================ */

/* Skills tab background - Default layout (no special background) */
.tab[data-tab="skills"] {
  position: relative;
  background-color: transparent;
  height: 367px;
}

/* Skills tab with class skill bar - For most classes */
.skills-layout-gnome .tab[data-tab="skills"],
.skills-layout-half-orc .tab[data-tab="skills"],
.skills-layout-hobbit .tab[data-tab="skills"] {
  background-image: url('/systems/osp-houserules/assets/character-sheet/class-skill-targets-bar.webp');
  background-size: contain;
  background-position: center top;
  background-repeat: no-repeat;
  background-attachment: scroll;
  background-color: transparent;
}

/* Skills tab for Barbarian - includes class bar and barbarian racial targets */
.skills-layout-barbarian .tab[data-tab="skills"] {
  background-image: url('/systems/osp-houserules/assets/character-sheet/class-skill-targets-bar.webp'), url('/systems/osp-houserules/assets/character-sheet/racial-skill-targets-barbarian.webp');
  background-size: contain, contain;
  /* Second image offset by 22px from top to position below the class bar */
  /* The calc(22px + 0%) syntax ensures CSS accepts it as a valid background-position */
  background-position: center top, center calc(22px + 0%);
  background-repeat: no-repeat, no-repeat;
  background-attachment: scroll, scroll;
  background-color: transparent;
}

/* Skills tab for Thief - includes thief-specific targets */
.skills-layout-thief .tab[data-tab="skills"] {
  background-image: url('/systems/osp-houserules/assets/character-sheet/class-skill-targets-bar.webp'), url('/systems/osp-houserules/assets/character-sheet/skill-targets-thief.webp');
  background-size: contain, contain;
  /* Second image offset by 22px from top to position below the class bar */
  background-position: center top, center calc(22px + 0%);
  background-repeat: no-repeat, no-repeat;
  background-attachment: scroll, scroll;
  background-color: transparent;
}

/* Skills tab for Assassin - includes both class bar and assassin-specific targets */
.skills-layout-assassin .tab[data-tab="skills"] {
  background-image: url('/systems/osp-houserules/assets/character-sheet/class-skill-targets-bar.webp'), url('/systems/osp-houserules/assets/character-sheet/skill-targets-assassin.webp');
  background-size: contain, contain;
  /* Second image offset by 22px from top to position below the class bar */
  background-position: center top, center calc(22px + 0%);
  background-repeat: no-repeat, no-repeat;
  background-attachment: scroll, scroll;
  background-color: transparent;
}

/* ============================
   CLASS SKILL POSITIONING FOR SKILLS TAB
   ============================ */

/* Move all class skill target fields to Skills tab when active */
.tab[data-tab="skills"] {
  /* Class-specific skill positioning - moved from Combat tab to Skills tab */
  .cs-pos-assassination { --left: 50px; --top: 50px; }
  .cs-pos-climb-sheer { --left: 150px; --top: 50px; }
  .cs-pos-hide-shadows { --left: 250px; --top: 50px; }
  .cs-pos-move-silently { --left: 350px; --top: 50px; }
  .cs-pos-find-traps { --left: 450px; --top: 50px; }
  .cs-pos-open-locks { --left: 100px; --top: 150px; }
  .cs-pos-pick-pockets { --left: 200px; --top: 150px; }
  .cs-pos-hide-undergrowth { --left: 300px; --top: 150px; }
}

/* Class skill fields are now physically located in the Skills tab */
