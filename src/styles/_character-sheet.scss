/* Character sheet specific styles extracted from templates/actors/character-sheet.html
   Migrate presentation out of the template and into this partial. */

/* White Background Override - Apply to entire sheet and window */
form.osp.sheet.actor.character,
.osp.sheet.actor.character,
.application.window-app.sheet.actor.character.osp,
.application.window-app.sheet.actor.character.osp .window-content,
.window-content form.osp.sheet.actor.character,
.window-content .osp.sheet.actor.character,
.window-content .window-content form.osp.sheet.actor.character,
.osp .window-content {
  background: white !important;
  background-color: white !important;
  background-image: none !important;
}

/* Single Background Image System - Applied to window instead of form */
form.osp.sheet.actor.character {
  position: relative;
}

/* Override any Foundry default backgrounds */
.osp.sheet.actor.character,
.application.window-app.sheet.actor.character.osp,
.window-content form.osp.sheet.actor.character,
.window-content .osp.sheet.actor.character,
.window-content .window-content form.osp.sheet.actor.character {
  background: white !important;
  background-color: white !important;
  background-image: none !important;
}

/* Ensure the application window allows tabs to extend beyond right edge */
.application.window-app.sheet.actor.character.osp {
  overflow: visible !important;
}

/* Prevent accidental stacking-contexts on ancestors which can break z-index ordering */
.application.window-app.sheet.actor.character.osp,
.application.window-app.sheet.actor.character.osp .window-content,
.osp.sheet.actor.character,
.window-content,
.window-content .window-content,
.osp .window-content,
form.osp.sheet.actor.character {
  transform: none !important;
  opacity: 1 !important;
  filter: none !important;
  will-change: auto !important;
  backface-visibility: visible !important;
}

/* Neutralize small transforms */
.languages-tags,
.portrait-img,
.char-name,
.char-class,
.char-align,
.char-race,
.char-age,
.char-sex,
.save-label-death span,
.save-label-wands span,
.save-label-paralysis span,
.save-label-breath span,
.save-label-spells span {
  transform: none !important;
  will-change: auto !important;
}

/* Window content wrapper */
.application.window-app.sheet.actor.character.osp .window-content,
.osp .window-content {
  background: white !important;
  background-color: white !important;
  background-image: none !important;
  padding: 0 !important;
  overflow: visible !important;
}

/* Black title bar for character sheet window */
.application.window-app.sheet.actor.character.osp .window-header,
.osp .window-header {
  background: black !important;
  background-color: black !important;
  border-bottom: 1px solid #333 !important;
}

.application.window-app.sheet.actor.character.osp .window-header .window-title,
.osp .window-header .window-title { color: white !important; }
.application.window-app.sheet.actor.character.osp .window-header .header-button,
.osp .window-header .header-button { color: white !important; }
.application.window-app.sheet.actor.character.osp .window-header .header-button:hover,
.osp .window-header .header-button:hover { background: rgba(255,255,255,0.2) !important; }

/* XP progress bar */
form.osp.sheet.actor.character .xp-progress-bar,
.osp.sheet.actor.character .xp-progress-bar { background-color: #4a90e2 !important; }

/* Static header background image */
form.osp.sheet.actor.character .static-header,
.static-header {
  background: url('systems/osp-houserules/assets/character-sheet/main-sheet.webp') no-repeat left top !important;
  background-position: left top !important;
  background-size: contain !important;
  background-color: transparent !important;
  margin-top: 0 !important;
  padding-top: 0 !important;
}

/* FORCE OVERRIDE: Remove all transparency from tabs */
form.osp.sheet.actor.character .sheet-tabs a.item,
.osp.sheet.actor.character .sheet-tabs a.item,
.sheet.actor.character .sheet-tabs a.item { opacity: 1 !important; background: white !important; background-color: white !important; box-shadow: none !important; }

form.osp.sheet.actor.character .sheet-tabs a.item:hover,
.osp.sheet.actor.character .sheet-tabs a.item:hover,
.sheet.actor.character .sheet-tabs a.item:hover { opacity: 1 !important; background: #f7f7f7 !important; }

form.osp.sheet.actor.character .sheet-tabs a.item.active,
.osp.sheet.actor.character .sheet-tabs a.item.active,
.sheet.actor.character .sheet-tabs a.item.active { opacity: 1 !important; background: white !important; }

/* Let JavaScript control z-index via variables or inline assignment */
form.osp.sheet.actor.character .sheet-tabs a.item:hover,
form.osp.sheet.actor.character .sheet-tabs a.item.active,
.osp.sheet.actor.character .sheet-tabs a.item:hover,
.osp.sheet.actor.character .sheet-tabs a.item.active,
.sheet.actor.character .sheet-tabs a.item:hover,
.sheet.actor.character .sheet-tabs a.item.active { z-index: inherit !important; }

/* Tab content area */
.sheet-body .tab { display: none; background: white !important; box-shadow: none !important; border: none !important; }
.sheet-body .tab.active { display: block; }

/* Height/Weight neutralization */
.char-height, .char-weight { box-shadow: none !important; background: transparent !important; border: none !important; border-radius: 0 !important; outline: none !important; }
.height-group, .weight-group { box-shadow: none !important; background: transparent !important; border: none !important; outline: none !important; }

/* HandW field */
.char-handw, .handw-group { border: none !important; box-sizing: border-box !important; }

/* XP Award Button */
button.xp-award-btn { color: #333 !important; background: none !important; border: none !important; outline: none !important; box-shadow: none !important; }
button.xp-award-btn:hover, button.xp-award-btn:focus { color: #dc2626 !important; }

/* Language tag styling */
.languages-tags .lang-tag { display: inline-flex; align-items: center; gap: 4px; background: #e0e0e0; padding: 2px 6px; border-radius: 3px; font-size: 12px; color: black !important; }
.languages-tags .lang-tag button.remove-lang { background: none; border: none; color: black !important; cursor: pointer; padding: 0 2px; font-size: 14px; line-height: 1; z-index: var(--z-lang-row, 101); }
.languages-tags .lang-tag button.remove-lang:hover { background: rgba(0,0,0,0.1); }
.languages-row.open-language-dialog { background: transparent !important; border: none !important; box-shadow: none !important; }
.languages-tags { background: transparent !important; border: none !important; box-shadow: none !important; pointer-events: auto; user-select: none; color: black !important; }
.languages-row.open-language-dialog:empty::before { content: "Click to add languages..."; color: black !important; font-style: italic; font-size: 12px; }
.languages-row::before,.languages-row::after,.languages-tags::before,.languages-tags::after,.open-language-dialog::before,.open-language-dialog::after { content: none !important; }
.languages-row .fa-plus,.languages-tags .fa-plus,.open-language-dialog .fa-plus { display: none !important; }

:root { --languages-horizontal-offset: 0px; --languages-vertical-offset: 0px; --languages-font-size: 24px; --languages-min-font-size: 10px; --languages-line-height: 1; --languages-letter-spacing: 0px; }
.languages-tags { transform: translate(var(--languages-horizontal-offset), var(--languages-vertical-offset)); font-size: var(--languages-font-size); line-height: var(--languages-line-height); letter-spacing: var(--languages-letter-spacing); }
.languages-tags:not([style*="font-size"]) { font-size: 24px !important; }

/* Portrait transform */
.portrait-img { transform: scale(var(--user-portrait-scale, 1)) translate(var(--user-portrait-x, 0px), var(--user-portrait-y, 0px)); transform-origin: center center; transition: transform 0.2s ease; }

.portrait-controls { position: absolute; top: 100%; left: 0; margin-top: 5px; background: rgba(0,0,0,0.95); color: white; padding: 3px; border-radius: 3px; display: none; z-index: var(--z-overlay, 1000); font-size: 10px; white-space: nowrap; border: 1px solid #666; box-shadow: 0 2px 4px rgba(0,0,0,0.5); }
.portrait-controls[style*="display: block"] { display: block !important; visibility: visible !important; opacity: 1 !important; }
.portrait-controls button { background: #555; color: white; border: 1px solid #777; padding: 2px 4px; margin: 1px; border-radius: 2px; cursor: pointer; font-size: 10px; width: 18px; height: 18px; line-height: 14px; display: inline-block; text-align: center; box-sizing: border-box; }
.portrait-controls button:hover { background: #777; border-color: #999; }
.portrait-controls button:active { background: #333; }
.portrait-controls .btn-group { display: inline-block; margin: 0 2px; vertical-align: top; }
.portrait-controls .btn-group:not(:last-child) { border-right: 1px solid #777; padding-right: 3px; }
.portrait-container.adjusting { outline: 1px dashed #00aaff; overflow: visible !important; z-index: calc(var(--z-overlay, 1000) + 1) !important; }

/* Tooltip classes to replace JS-injected cssText */
.cs-tooltip { position: absolute; background: #333; color: white; padding: 8px 12px; border-radius: 4px; font-size: 12px; line-height: 1.4; z-index: var(--z-overlay, 1000); pointer-events: none; opacity: 0; transition: opacity 0.2s; white-space: nowrap; }
.cs-tooltip--xp { box-shadow: 0 2px 8px rgba(0,0,0,0.3); z-index: var(--z-top, 10000); }
.cs-tooltip--portrait { box-shadow: 0 2px 8px rgba(0,0,0,0.3); z-index: var(--z-top, 10000); }

/* Level & portrait container utility classes (migrate inline box-shadow/positioning into class-based rules) */
.cs-level-container { position: absolute; width: 64px; height: 34px; }
.cs-level-shadow { position: absolute; top: 0; left: 0; width: 64px; height: 34px; z-index: var(--z-labels, 15); pointer-events: none; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8); border-radius: 6px; }

/* Static header helper */
.cs-static-header { height: 230px; flex-shrink: 0; position: relative; z-index: var(--z-sheet, 10); background-size: 100% auto !important; background-color: transparent !important; margin-top: 0 !important; padding-top: 0 !important; pointer-events: none; }

/* Combat and ability layouts markup helpers */
.cs-combat-stats { display: flex; gap: 1.5rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap; }
.cs-combat-stat { display: flex; flex-direction: column; align-items: center; }
.cs-save-badge { width: 75px; height: 75px; border: 2px solid #4a5568; border-radius: 50%; position: relative; background-color: white; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15); }

/* Ability score box */
.cs-ability-select { width: 75px; height: 75px; text-align: center; font-size: 70px; font-weight: normal; background-color: white !important; appearance: none; line-height: 1; padding: 8px 3px 0 0; display: flex; align-items: center; justify-content: center; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8); }

/* Misc helpers for textareas in bio */
.cs-bio-textarea { width: 100%; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white; }

/* Encumbrance bar helpers */
.encumbrance-section .encumbrance-bar-container { position: relative; }
.encumbrance-section .encumbrance-bar { height: 12px; background: #22c55e; transition: width 0.3s ease; }

/* Level progress helpers */
.cs-level-progress-bar { position: absolute; top: 0; left: 0; height: 100%; border-radius: 3px; background-color: #22c55e; width: 0%; transition: width 0.3s ease; }
.cs-level-display { position: absolute; top: 2px; left: 0; width: 100%; height: 100%; font-size: 24px; color: #000; z-index: var(--z-level, 8); line-height: 34px; font-family: 'Minion Pro', serif; text-align: center; box-sizing: border-box; background: transparent !important; box-shadow: none !important; display: flex; align-items: center; justify-content: center; }

/* Portrait helpers - keep per-actor CSS variables inline for transform */
.cs-portrait-container { position: absolute; width: var(--portrait-size); height: 141px; overflow: hidden; }
.cs-portrait-display { position: absolute; top: 0; left: 0; width: 100%; height: 100%; cursor: pointer; border-radius: 3px; overflow: hidden; pointer-events: auto; }
.cs-portrait-img { width:100%; height:100%; object-fit:contain; display:block; }

/* XP/Next level small field helpers */
.cs-field { background-color: transparent !important; border: none; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8) !important; appearance: none; padding: 4px 0 0 0; margin: 0; line-height: 1; color: inherit; display: flex; align-items: center; justify-content: center; }
.cs-xp-mod-display { width: 64px; height: 34px; text-align: center; font-size: 24px; pointer-events: none; }
.cs-xp-display { width: 134px; height: 34px; text-align: center; font-size: 24px; cursor: pointer; pointer-events: auto; }
.cs-next-level-display { width: 134px; height: 34px; text-align: center; font-size: 24px; pointer-events: none; }

/* Keep this partial focused on presentation only; behavior remains in JS. */
