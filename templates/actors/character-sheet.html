<form class="osp sheet actor character" autocomplete="off" style="height: 100%; display: flex; flex-direction: column; overflow: hidden; font-family: 'Minion Pro', serif; font-weight: normal; width: 600px; max-width: 600px;">
  <style>
    /* Single Background Image System */
    form.osp.sheet.actor.character {
      position: relative;
      background: transparent !important;
      background-image: url('systems/osp-houserules/assets/backgrounds/character-sheet-background.jpg') !important;
      background-repeat: no-repeat !important;
      background-size: cover !important;
      background-position: center !important;
      background-color: transparent !important;
    }
    
    /* Override any Foundry default backgrounds */
    .osp.sheet.actor.character,
    .application.window-app.sheet.actor.character.osp,
    .window-content form.osp.sheet.actor.character,
    .window-content .osp.sheet.actor.character,
    .window-content .window-content form.osp.sheet.actor.character {
      background-color: transparent !important;
    }
    
    /* Also override the window content wrapper */
    .application.window-app.sheet.actor.character.osp .window-content,
    .osp .window-content {
      background: transparent !important;
      background-image: none !important;
      background-color: transparent !important;
    }
    
    /* Keep character name with its original styling */
    .char-name {
      font-family: inherit !important;
      font-weight: bold !important;
    }
    
    /* Character name background should be transparent */
    form.osp.sheet.actor.character input.char-name,
    form.osp.sheet.actor.character input#char-name,
    .osp.sheet.actor.character input.char-name,
    .osp.sheet.actor.character input#char-name {
      background-color: transparent !important;
      background: transparent !important;
    }
    
  
    /* XP progress bar should be visible with different color */
    form.osp.sheet.actor.character .xp-progress-bar,
    .osp.sheet.actor.character .xp-progress-bar {
      background-color: #4a90e2 !important;
    }
    
    /* Tab system styles */
    .sheet-tabs a.item {
      padding: 0.25rem 0.75rem;
      margin-right: 0.25rem;
      cursor: pointer;
      text-decoration: none;
      color: #333;
      display: inline-block;
      position: relative;
      z-index: 100;
      pointer-events: auto;
      user-select: none;
      font-family: 'Futura Condensed', 'Futura-CondensedMedium', 'Futura PT Condensed', 'Arial Narrow', 'Helvetica Condensed', sans-serif;
    }
    .sheet-tabs a.item.active {
      border-bottom: 1px solid transparent;
      font-weight: bold;
    }
    .sheet-body .tab {
      display: none;
    }
    .sheet-body .tab.active {
      display: block;
    }
    /* Ensure tab container doesn't block clicks */
    .sheet-tabs {
      position: relative;
      z-index: 10;
    }
    /* XP Award Button Hover Effect */
    button.xp-award-btn {
      color: #333 !important;
      background: none !important;
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
    }
    button.xp-award-btn:hover {
      color: #dc2626 !important;
      background: none !important;
      border: none !important;
      outline: none !important;
      box-shadow: none !important;
    }
    button.xp-award-btn:focus {
      color: #dc2626 !important;
      outline: none !important;
      box-shadow: none !important;
      background: none !important;
      border: none !important;
    }
  </style>
  
  <!-- Static Header Section - Absolutely fixed at top -->
    <div class="static-header" style="padding: 0.75rem; height: 380px; flex-shrink: 0; position: relative; z-index: 10;">
      <div style="display: flex; flex-direction: column; height: 100%; gap: 0.75rem;">
        
        <!-- Top Row: Character Image, Name/Class/Alignment/Level -->
        <div style="display: flex; gap: 1rem; align-items: flex-start;">
          <!-- Left: Character Image -->
          <div class="character-image-container char-field-group" style="position: relative; flex-shrink: 0;">
            <div class="character-image" style="position: relative; width: 100px; height: 100px; border: 2px solid #ccc; border-radius: 8px; overflow: hidden;">
              <img src="{{actor.img}}" alt="{{actor.name}}" title="{{actor.name}}"
                   class="character-portrait" 
                   style="position: absolute; width: 100%; height: 100%; object-fit: cover; transform-origin: top left; user-select: none;" 
                   draggable="false" />
            </div>
            <!-- Control buttons -->
            <div class="image-controls" style="position: absolute; top: -8px; right: -8px; display: none; gap: 4px;">
              <button type="button" class="reset-image" title="Reset Position & Size" style="width: 24px; height: 24px; border: none; border-radius: 50%; background: #4a5568; color: white; font-size: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center;">↻</button>
              <button type="button" class="fit-image" title="Fit to Container" style="width: 24px; height: 24px; border: none; border-radius: 50%; background: #4a5568; color: white; font-size: 10px; cursor: pointer; display: flex; align-items: center; justify-content: center;">⌂</button>
            </div>
          </div>
          
          <!-- Center: Character Name and Basic Info -->
          <div style="flex: 1; display: flex; flex-direction: column; gap: 0.5rem; min-width: 200px;">
            <!-- Character Name -->
            <div class="character-name-section" style="text-align: center;">
              <input class="char-name" id="char-name" name="name" type="text" value="{{actor.name}}" placeholder="Enter name" style="border: none; background: transparent; padding: 0; text-align: center; width: 100%; font-size: 1.4rem; font-weight: bold; outline: none; box-shadow: none;"/>
            </div>
            
            <!-- Class, Alignment, Level Row -->
            <div style="display: flex; gap: 0.75rem; justify-content: center; align-items: end; flex-wrap: wrap;">
              <!-- Character Class -->
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-class" style="font-size: 18px; font-family: 'Futura Condensed', sans-serif;">Class</label>
                <select class="char-class" id="char-class" name="system.class" style="width: 90px; height: 1.5em; text-align: center; font-size: 18px; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; display: flex; align-items: center; justify-content: center; line-height: 1; padding: 3px 0 0 0; margin: 0;">
                <option value="Assassin" {{#if (eq system.class "Assassin")}}selected{{/if}}>Assassin</option>
                <option value="Barbarian" {{#if (eq system.class "Barbarian")}}selected{{/if}}>Barbarian</option>
                <option value="Bard" {{#if (eq system.class "Bard")}}selected{{/if}}>Bard</option>
                <option value="Beast Master" {{#if (eq system.class "Beast Master")}}selected{{/if}}>Beast Master</option>
                <option value="Cleric" {{#if (eq system.class "Cleric")}}selected{{/if}}>Cleric</option>
                <option value="Druid" {{#if (eq system.class "Druid")}}selected{{/if}}>Druid</option>
                <option value="Dwarf" {{#if (eq system.class "Dwarf")}}selected{{/if}}>Dwarf</option>
                <option value="Elf" {{#if (eq system.class "Elf")}}selected{{/if}}>Elf</option>
                <option value="Fighter" {{#if (eq system.class "Fighter")}}selected{{/if}}>Fighter</option>
                <option value="Gnome" {{#if (eq system.class "Gnome")}}selected{{/if}}>Gnome</option>
                <option value="Half-Elf" {{#if (eq system.class "Half-Elf")}}selected{{/if}}>Half-Elf</option>
                <option value="Half-Orc" {{#if (eq system.class "Half-Orc")}}selected{{/if}}>Half-Orc</option>
                <option value="Hobbit" {{#if (eq system.class "Hobbit")}}selected{{/if}}>Hobbit</option>
                <option value="Illusionist" {{#if (eq system.class "Illusionist")}}selected{{/if}}>Illusionist</option>
                <option value="Knight" {{#if (eq system.class "Knight")}}selected{{/if}}>Knight</option>
                <option value="Mage" {{#if (eq system.class "Mage")}}selected{{/if}}>Mage</option>
                <option value="Magic-User" {{#if (eq system.class "Magic-User")}}selected{{/if}}>Magic-User</option>
                <option value="Paladin" {{#if (eq system.class "Paladin")}}selected{{/if}}>Paladin</option>
                <option value="Ranger" {{#if (eq system.class "Ranger")}}selected{{/if}}>Ranger</option>
                <option value="Thief" {{#if (eq system.class "Thief")}}selected{{/if}}>Thief</option>
                <option value="Warden" {{#if (eq system.class "Warden")}}selected{{/if}}>Warden</option>
              </select>
            </div>
            
            <!-- Character Alignment -->
            <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
              <label for="char-align" style="font-size: 18px; font-family: 'Futura Condensed', sans-serif;">Alignment</label>
              <select class="char-align" id="char-align" name="system.alignment" style="width: 65px; height: 1.5em; text-align: center; font-size: 18px; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; display: flex; align-items: center; justify-content: center; line-height: 1; padding: 3px 0 0 0; margin: 0;">
                <option value="Chaotic" {{#if (eq system.alignment "Chaotic")}}selected{{/if}}>Chaotic</option>
                <option value="Lawful" {{#if (eq system.alignment "Lawful")}}selected{{/if}}>Lawful</option>
                <option value="Neutral" {{#if (eq system.alignment "Neutral")}}selected{{/if}}>Neutral</option>
              </select>
            </div>
            
            <!-- Character Level -->
            <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
              <label for="char-level" style="font-size: 18px; font-family: 'Futura Condensed', sans-serif;">Level</label>
              <select class="char-level" id="char-level" name="system.level" style="width: 40px; height: 1.5em; text-align: center; font-size: 18px; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; display: flex; align-items: center; justify-content: center; line-height: 1; padding: 3px 0 0 0; margin: 0;">
                <option value="1" {{#if (eq system.level "1")}}selected{{/if}}>1</option>
                <option value="2" {{#if (eq system.level "2")}}selected{{/if}}>2</option>
                <option value="3" {{#if (eq system.level "3")}}selected{{/if}}>3</option>
                <option value="4" {{#if (eq system.level "4")}}selected{{/if}}>4</option>
                <option value="5" {{#if (eq system.level "5")}}selected{{/if}}>5</option>
                <option value="6" {{#if (eq system.level "6")}}selected{{/if}}>6</option>
                <option value="7" {{#if (eq system.level "7")}}selected{{/if}}>7</option>
                <option value="8" {{#if (eq system.level "8")}}selected{{/if}}>8</option>
                <option value="9" {{#if (eq system.level "9")}}selected{{/if}}>9</option>
                <option value="10" {{#if (eq system.level "10")}}selected{{/if}}>10</option>
                <option value="11" {{#if (eq system.level "11")}}selected{{/if}}>11</option>
                <option value="12" {{#if (eq system.level "12")}}selected{{/if}}>12</option>
                <option value="13" {{#if (eq system.level "13")}}selected{{/if}}>13</option>
                <option value="14" {{#if (eq system.level "14")}}selected{{/if}}>14</option>
              </select>
            </div>
          </div>
          
          <!-- Ability Scores Row -->
          <div class="ability-scores-section" style="display: flex; gap: 0.5rem; justify-content: center; margin-top: 1rem;">
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 36px; font-family: 'Council', serif; letter-spacing: 0.03em;">STR</label>
              <select class="attr-str" id="attr-str" name="system.attributes.str.value" style="width: 60px; height: 60px; text-align: center; font-size: 42px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.str.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -10px; font-size: 12px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 30px; height: 24px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.str.value}}
              </div>
            </div>
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 45px; font-family: 'Council', serif; letter-spacing: 0.03em;">DEX</label>
              <select class="attr-dex" id="attr-dex" name="system.attributes.dex.value" style="width: 75px; height: 75px; text-align: center; font-size: 54px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.dex.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -12px; font-size: 15px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 38px; height: 30px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.dex.value}}
              </div>
            </div>
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 45px; font-family: 'Council', serif; letter-spacing: 0.03em;">CON</label>
              <select class="attr-con" id="attr-con" name="system.attributes.con.value" style="width: 75px; height: 75px; text-align: center; font-size: 54px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.con.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -12px; font-size: 15px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 38px; height: 30px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.con.value}}
              </div>
            </div>
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 45px; font-family: 'Council', serif; letter-spacing: 0.03em;">INT</label>
              <select class="attr-int" id="attr-int" name="system.attributes.int.value" style="width: 75px; height: 75px; text-align: center; font-size: 54px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.int.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -12px; font-size: 15px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 38px; height: 30px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.int.value}}
              </div>
            </div>
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 45px; font-family: 'Council', serif; letter-spacing: 0.03em;">WIS</label>
              <select class="attr-wis" id="attr-wis" name="system.attributes.wis.value" style="width: 75px; height: 75px; text-align: center; font-size: 54px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.wis.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -12px; font-size: 15px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 38px; height: 30px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.wis.value}}
              </div>
            </div>
            <div class="ability" style="display: flex; flex-direction: column; align-items: center;">
              <label style="font-size: 45px; font-family: 'Council', serif; letter-spacing: 0.03em;">CHA</label>
              <select class="attr-cha" id="attr-cha" name="system.attributes.cha.value" style="width: 75px; height: 75px; text-align: center; font-size: 54px; font-weight: bold; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; line-height: 1; padding: 0; margin: 0; display: flex; align-items: center; justify-content: center; transform: translateY(4px); border: 3px solid #ccc; border-radius: 9px; box-shadow: inset 3px 3px 6px rgba(0,0,0,0.15), inset -2px -2px 3px rgba(255,255,255,0.8);">
                {{#each (range 3 18) as |val|}}
                  <option value="{{val}}" {{#if (eq (parseInt ../system.attributes.cha.value) val)}}selected{{/if}}>{{val}}</option>
                {{/each}}
              </select>
              <div style="margin-top: -12px; font-size: 15px; color: #ffffff; border: 2px solid #000; border-radius: 50%; width: 38px; height: 30px; display: flex; align-items: center; justify-content: center; position: relative; z-index: 10; background-color: #000000;">
                {{abilityMod system.attributes.cha.value}}
              </div>
            </div>
          </div>
        </div>
        
        <!-- Right Side: XP Progress -->
        <div class="char-field-group xp-progress-section" style="display: flex; flex-direction: column; align-items: center; flex-shrink: 0; line-height: 1;">
          <!-- Character Level -->
          <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center; margin-bottom: 0.5rem;">
            <label for="char-level" style="font-size: 27px; font-family: 'Futura Condensed', sans-serif;">Level</label>
            <select class="char-level" id="char-level" name="system.level" style="width: 75px; height: 75px; text-align: center; font-size: 54px; background-color: white !important; appearance: none; -webkit-appearance: none; -moz-appearance: none; display: flex; align-items: center; justify-content: center; line-height: 1; padding: 9px 0 0 0; margin: 0;">
              <option value="1" {{#if (eq system.level "1")}}selected{{/if}}>1</option>
              <option value="2" {{#if (eq system.level "2")}}selected{{/if}}>2</option>
              <option value="3" {{#if (eq system.level "3")}}selected{{/if}}>3</option>
              <option value="4" {{#if (eq system.level "4")}}selected{{/if}}>4</option>
              <option value="5" {{#if (eq system.level "5")}}selected{{/if}}>5</option>
              <option value="6" {{#if (eq system.level "6")}}selected{{/if}}>6</option>
              <option value="7" {{#if (eq system.level "7")}}selected{{/if}}>7</option>
              <option value="8" {{#if (eq system.level "8")}}selected{{/if}}>8</option>
              <option value="9" {{#if (eq system.level "9")}}selected{{/if}}>9</option>
              <option value="10" {{#if (eq system.level "10")}}selected{{/if}}>10</option>
              <option value="11" {{#if (eq system.level "11")}}selected{{/if}}>11</option>
              <option value="12" {{#if (eq system.level "12")}}selected{{/if}}>12</option>
              <option value="13" {{#if (eq system.level "13")}}selected{{/if}}>13</option>
              <option value="14" {{#if (eq system.level "14")}}selected{{/if}}>14</option>
            </select>
          </div>
          <div style="display: flex; align-items: center; margin-bottom: -2px; line-height: 1;">
            <button class="xp-award-btn" type="button" title="Award XP" style="border: none; background: none; color: #333; font-size: 12px; cursor: pointer; padding: 0; margin-right: 1px; line-height: 1; position: relative; top: -1px;">+</button>
            <div class="xp-display" style="display: flex; align-items: center; font-size: 10px; line-height: 1;">
              <span class="char-xp" style="text-align: center; font-family: 'Minion Pro', serif;">{{system.xp}}</span>
              <span style="margin: 0 1px; font-weight: normal;"> / </span>
              <span class="next-level-xp" style="font-family: 'Minion Pro', serif;">{{getNextLevelXP system.class system.level}}</span>
            </div>
          </div>
          <div style="display: flex; align-items: center; gap: 0; margin-bottom: 1px; line-height: 1;">
            <span style="font-size: 12px; margin-right: 6px;">{{system.level}}</span>
            <div class="xp-progress-container" style="width: 120px; height: 25px; border: 1px solid #ccc; position: relative; border-radius: 3px;">
              <div class="xp-progress-bar" style="height: 100%; width: 0%; transition: width 0.3s ease; border-radius: 2px;"></div>
              <div class="xp-progress-label" style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 9px; color: #000; text-shadow: 1px 1px 1px rgba(255,255,255,0.8);">
                XP (<span class="xp-percentage">0</span>%)
              </div>
            </div>
            <span style="font-size: 12px; margin-left: 6px;">
              {{#if (eq system.level "1")}}2{{/if}}
              {{#if (eq system.level "2")}}3{{/if}}
              {{#if (eq system.level "3")}}4{{/if}}
              {{#if (eq system.level "4")}}5{{/if}}
              {{#if (eq system.level "5")}}6{{/if}}
              {{#if (eq system.level "6")}}7{{/if}}
              {{#if (eq system.level "7")}}8{{/if}}
              {{#if (eq system.level "8")}}9{{/if}}
              {{#if (eq system.level "9")}}10{{/if}}
              {{#if (eq system.level "10")}}11{{/if}}
              {{#if (eq system.level "11")}}12{{/if}}
              {{#if (eq system.level "12")}}13{{/if}}
              {{#if (eq system.level "13")}}14{{/if}}
              {{#if (eq system.level "14")}}—{{/if}}
            </span>
          </div>
        </div>
        
      </div>
    </div>

    <!-- Scrollable Content Area -->
    <div class="scrollable-content" style="flex: 1; overflow-y: auto; overflow-x: hidden; padding: 0;">
      
      <!-- Sheet Tab Navigation -->
      <nav class="sheet-tabs tabs" data-group="primary" style="display: flex; margin: 0; padding: 0.5rem 0.75rem 0; gap: 0.25rem; background: transparent; flex-shrink: 0;">
        <a class="item" data-tab="combat">Combat</a>
        <a class="item" data-tab="skills">Skills</a>
        <a class="item" data-tab="equipment">Equipment</a>
        <a class="item" data-tab="bio">Bio</a>
      </nav>

      <!-- Sheet Body -->
      <section class="sheet-body" style="padding: 1rem 0.75rem; flex: 1;">
      <!-- Combat Tab -->
      <div class="tab" data-group="primary" data-tab="combat">
        <div class="combat-section">
          <h3>Combat Stats</h3>
          <div class="combat-stats" style="display: flex; gap: 1.5rem; justify-content: center; margin-bottom: 2rem; flex-wrap: wrap;">
            <div class="combat-stat" style="display: flex; flex-direction: column; align-items: center;">
              <label for="char-ac" style="margin-bottom: 0.5rem; font-size: 1.1rem;">Armor Class</label>
              <input class="char-ac" id="char-ac" name="system.ac" type="number" value="{{system.ac}}" min="0" max="20" style="width: 80px; height: 40px; text-align: center; font-size: 1.2rem; border: 2px solid #4a5568; border-radius: 8px; background-color: white;" />
            </div>
            <div class="combat-stat" style="display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.5rem; font-size: 1.1rem;">Unarmored AC</label>
              <div style="width: 80px; height: 40px; text-align: center; font-size: 1.2rem; border: 2px solid #4a5568; border-radius: 8px; display: flex; align-items: center; justify-content: center; background-color: white;">
                {{unarmoredAC system.attributes.dex.value}}
              </div>
            </div>
            <div class="combat-stat" style="display: flex; flex-direction: column; align-items: center;">
              <label for="char-hp" style="margin-bottom: 0.5rem; font-size: 1.1rem;">Current HP</label>
              <input class="char-hp" id="char-hp" name="system.hitpoints" type="number" value="{{system.hitpoints}}" min="0" style="width: 80px; height: 40px; text-align: center; font-size: 1.2rem; border: 2px solid #4a5568; border-radius: 8px; background-color: white;" />
            </div>
            <div class="combat-stat" style="display: flex; flex-direction: column; align-items: center;">
              <label for="char-max-hp" style="margin-bottom: 0.5rem; font-size: 1.1rem;">Max HP</label>
              <input class="char-max-hp" id="char-max-hp" name="system.maxhitpoints" type="number" value="{{system.maxhitpoints}}" min="0" style="width: 80px; height: 40px; text-align: center; font-size: 1.2rem; border: 2px solid #4a5568; border-radius: 8px; background-color: white;" />
            </div>
          </div>

          <h3>Saving Throws</h3>
          <div class="saving-throws" style="display: flex; gap: 1rem; flex-wrap: wrap;">
            <div class="save" style="flex: 1 1 80px; display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.25rem;">Death Ray / Poison</label>
              <div style="width: 40px; height: 40px; border: 2px solid #4a5568; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; background-color: white;">
                {{saves.death.value}}
              </div>
            </div>
            <div class="save" style="flex: 1 1 80px; display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.25rem;">Magic Wands</label>
              <div style="width: 40px; height: 40px; border: 2px solid #4a5568; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; background-color: white;">
                {{saves.wands.value}}
              </div>
            </div>
            <div class="save" style="flex: 1 1 80px; display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.25rem;">Paralysis / Turn to Stone</label>
              <div style="width: 40px; height: 40px; border: 2px solid #4a5568; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; background-color: white;">
                {{saves.paralysis.value}}
              </div>
            </div>
            <div class="save" style="flex: 1 1 80px; display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.25rem;">Dragon Breath</label>
              <div style="width: 40px; height: 40px; border: 2px solid #4a5568; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; background-color: white;">
                {{saves.breath.value}}
              </div>
            </div>
            <div class="save" style="flex: 1 1 80px; display: flex; flex-direction: column; align-items: center;">
              <label style="margin-bottom: 0.25rem;">Rod / Staff / Spell</label>
              <div style="width: 40px; height: 40px; border: 2px solid #4a5568; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; background-color: white;">
                {{saves.spells.value}}
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Skills Tab -->
      <div class="tab" data-group="primary" data-tab="skills">
        <!-- Skills tab content (blank for now) -->
      </div>
      <!-- Equipment Tab -->
      <div class="tab" data-group="primary" data-tab="equipment">
        <section class="equipment-tab">
          {{!-- Weapons Section --}}
          <div class="item-category">
            <div class="item-category-title flexrow">
              <div class="category-caret"><i class="fas fa-caret-down"></i></div>
              <div class="category-name">Weapons</div>
              <div class="field-short">Damage</div>
              <div class="field-short">Weight</div>
              <div class="item-controls">
                <a class="item-control item-create" data-type="weapon" title="Add Weapon">
                  <i class="fa fa-plus"></i>
                </a>
              </div>
            </div>
            <ol class="item-list">
              {{#each weapons as |item|}}
              <li class="item-entry item" data-item-id="{{item.id}}">
                <div class="item-header flexrow {{#if item.isWeapon}}item-rollable{{/if}}">
                  <div class="item-image" style="background-image: url({{item.img}})"></div>
                  <h4 class="item-name" title="{{item.name}}">{{item.name}}</h4>
                  <div class="field-short">{{item.system.damage}}</div>
                  <div class="field-short">{{item.system.weight}}</div>
                  <div class="item-controls">
                    {{#if @root.owner}}
                    <a class="item-control item-show" title="Show Item">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="item-control item-toggle {{#unless item.system.equipped}}item-unequipped{{/unless}}" title="Equip/Unequip">
                      <i class="fas fa-hand"></i>
                    </a>
                    <a class="item-control item-edit" title="Edit Item">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a class="item-control item-delete" title="Delete Item">
                      <i class="fas fa-trash"></i>
                    </a>
                    {{/if}}
                  </div>
                </div>
                <div class="item-summary {{#if item.isExpanded}}expanded{{/if}}">
                  {{#if item.system.description}}
                  <div class="item-description">{{item.system.description}}</div>
                  {{/if}}
                  {{#if item.displayTags}}
                  <div class="item-tags">
                    {{#each item.displayTags as |tag|}}
                    <span class="tag">{{tag.value}}</span>
                    {{/each}}
                  </div>
                  {{/if}}
                </div>
              </li>
              {{/each}}
            </ol>
          </div>

          {{!-- Armor Section --}}
          <div class="item-category">
            <div class="item-category-title flexrow">
              <div class="category-caret"><i class="fas fa-caret-down"></i></div>
              <div class="category-name">Armor</div>
              <div class="field-short">AC</div>
              <div class="field-short">Weight</div>
              <div class="item-controls">
                <a class="item-control item-create" data-type="armor" title="Add Armor">
                  <i class="fa fa-plus"></i>
                </a>
              </div>
            </div>
            <ol class="item-list">
              {{#each armor as |item|}}
              <li class="item-entry item" data-item-id="{{item.id}}">
                <div class="item-header flexrow">
                  <div class="item-image" style="background-image: url({{item.img}})"></div>
                  <h4 class="item-name" title="{{item.name}}">{{item.name}}</h4>
                  <div class="field-short">{{item.system.ac.value}}</div>
                  <div class="field-short">{{item.system.weight}}</div>
                  <div class="item-controls">
                    {{#if @root.owner}}
                    <a class="item-control item-show" title="Show Item">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="item-control item-toggle {{#unless item.system.equipped}}item-unequipped{{/unless}}" title="Equip/Unequip">
                      <i class="fas fa-tshirt"></i>
                    </a>
                    <a class="item-control item-edit" title="Edit Item">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a class="item-control item-delete" title="Delete Item">
                      <i class="fas fa-trash"></i>
                    </a>
                    {{/if}}
                  </div>
                </div>
                <div class="item-summary {{#if item.isExpanded}}expanded{{/if}}">
                  {{#if item.system.description}}
                  <div class="item-description">{{item.system.description}}</div>
                  {{/if}}
                </div>
              </li>
              {{/each}}
            </ol>
          </div>

          {{!-- Containers Section --}}
          <div class="item-category">
            <div class="item-category-title flexrow">
              <div class="category-caret"><i class="fas fa-caret-down"></i></div>
              <div class="category-name">Containers</div>
              <div class="field-short">Capacity</div>
              <div class="field-short">Weight</div>
              <div class="item-controls">
                <a class="item-control item-create" data-type="container" title="Add Container">
                  <i class="fa fa-plus"></i>
                </a>
              </div>
            </div>
            <ol class="item-list">
              {{#each containers as |item|}}
              <li class="item-entry item" data-item-id="{{item.id}}">
                <div class="item-header flexrow">
                  <div class="item-image" style="background-image: url({{item.img}})"></div>
                  <h4 class="item-name" title="{{item.name}}">{{item.name}}</h4>
                  <div class="field-short">{{item.system.capacity.value}}/{{item.system.capacity.max}}</div>
                  <div class="field-short">{{item.system.weight}}</div>
                  <div class="item-controls">
                    {{#if @root.owner}}
                    <a class="item-control item-show" title="Show Item">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="item-control item-toggle {{#unless item.system.equipped}}item-unequipped{{/unless}}" title="Equip/Unequip">
                      <i class="fas fa-hand"></i>
                    </a>
                    <a class="item-control item-edit" title="Edit Item">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a class="item-control item-delete" title="Delete Item">
                      <i class="fas fa-trash"></i>
                    </a>
                    {{/if}}
                  </div>
                </div>
                <div class="item-summary {{#if item.isExpanded}}expanded{{/if}}">
                  {{#if item.system.description}}
                  <div class="item-description">{{item.system.description}}</div>
                  {{/if}}
                </div>
              </li>
              {{/each}}
            </ol>
          </div>

          {{!-- General Items Section --}}
          <div class="item-category">
            <div class="item-category-title flexrow">
              <div class="category-caret"><i class="fas fa-caret-down"></i></div>
              <div class="category-name">Items</div>
              <div class="field-short">Qty</div>
              <div class="field-short">Weight</div>
              <div class="item-controls">
                <a class="item-control item-create" data-type="item" title="Add Item">
                  <i class="fa fa-plus"></i>
                </a>
              </div>
            </div>
            <ol class="item-list">
              {{#each items as |item|}}
              <li class="item-entry item" data-item-id="{{item.id}}">
                <div class="item-header flexrow">
                  <div class="item-image" style="background-image: url({{item.img}})"></div>
                  <h4 class="item-name" title="{{item.name}}">{{item.name}}</h4>
                  <div class="field-short quantity">
                    <input 
                      value="{{item.system.quantity.value}}" 
                      type="number" 
                      min="0" 
                      data-field="system.quantity.value"
                      data-item-id="{{item.id}}"
                    />
                    {{#if item.system.quantity.max}}
                    <span>/{{item.system.quantity.max}}</span>
                    {{/if}}
                  </div>
                  <div class="field-short">{{multiply item.system.weight item.system.quantity.value}}</div>
                  <div class="item-controls">
                    {{#if @root.owner}}
                    <a class="item-control item-show" title="Show Item">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="item-control item-toggle {{#unless item.system.equipped}}item-unequipped{{/unless}}" title="Equip/Unequip">
                      <i class="fas fa-hand"></i>
                    </a>
                    <a class="item-control item-edit" title="Edit Item">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a class="item-control item-delete" title="Delete Item">
                      <i class="fas fa-trash"></i>
                    </a>
                    {{/if}}
                  </div>
                </div>
                <div class="item-summary {{#if item.isExpanded}}expanded{{/if}}">
                  {{#if item.system.description}}
                  <div class="item-description">{{item.system.description}}</div>
                  {{/if}}
                </div>
              </li>
              {{/each}}
            </ol>
          </div>

          {{!-- Treasure Section --}}
          <div class="item-category">
            <div class="item-category-title flexrow">
              <div class="category-caret"><i class="fas fa-caret-down"></i></div>
              <div class="category-name">Treasure</div>
              <div class="field-short">Value</div>
              <div class="field-short">Weight</div>
              <div class="item-controls">
                <a class="item-control item-create" data-type="item" data-treasure="true" title="Add Treasure">
                  <i class="fa fa-plus"></i>
                </a>
              </div>
            </div>
            <ol class="item-list">
              {{#each treasures as |item|}}
              <li class="item-entry item" data-item-id="{{item.id}}">
                <div class="item-header flexrow">
                  <div class="item-image" style="background-image: url({{item.img}})"></div>
                  <h4 class="item-name" title="{{item.name}}">{{item.name}}</h4>
                  <div class="field-short">{{item.system.cumulativeCost}} gp</div>
                  <div class="field-short">{{item.system.cumulativeWeight}}</div>
                  <div class="item-controls">
                    {{#if @root.owner}}
                    <a class="item-control item-show" title="Show Item">
                      <i class="fas fa-eye"></i>
                    </a>
                    <a class="item-control item-edit" title="Edit Item">
                      <i class="fas fa-edit"></i>
                    </a>
                    <a class="item-control item-delete" title="Delete Item">
                      <i class="fas fa-trash"></i>
                    </a>
                    {{/if}}
                  </div>
                </div>
                <div class="item-summary {{#if item.isExpanded}}expanded{{/if}}">
                  {{#if item.system.description}}
                  <div class="item-description">{{item.system.description}}</div>
                  {{/if}}
                </div>
              </li>
              {{/each}}
            </ol>
          </div>

          {{!-- Encumbrance Bar --}}
          <section class="encumbrance-section">
            <div class="encumbrance-label">Encumbrance</div>
            <div class="encumbrance-bar-container">
              <div class="encumbrance-bar" style="width: {{encumbrancePercentage}}%"></div>
              <span class="encumbrance-text">{{totalWeight}} / {{maxWeight}} lbs</span>
            </div>
          </section>
          </section>
        </div>

      <!-- Bio Tab -->
      <div class="tab" data-group="primary" data-tab="bio">
        <div class="bio-content" style="padding: 1rem; display: flex; flex-direction: column; gap: 1rem;">          <!-- Physical Characteristics Section -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Physical Characteristics</h3>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: flex-start; min-height: 60px; padding: 10px;">
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-race" style="margin-bottom: 2px; text-align: center; font-size: 14px;">Race</label>
                <select class="char-race" id="char-race" name="system.race" style="width: 80px; height: 2.5em; text-align: center; background-color: white;">
                  <option value="Dwarf" {{#if (eq system.race "Dwarf")}}selected{{/if}}>Dwarf</option>
                  <option value="Elf" {{#if (eq system.race "Elf")}}selected{{/if}}>Elf</option>
                  <option value="Gnome" {{#if (eq system.race "Gnome")}}selected{{/if}}>Gnome</option>
                  <option value="Half-Elf" {{#if (eq system.race "Half-Elf")}}selected{{/if}}>Half-Elf</option>
                  <option value="Half-Orc" {{#if (eq system.race "Half-Orc")}}selected{{/if}}>Half-Orc</option>
                  <option value="Hobbit" {{#if (eq system.race "Hobbit")}}selected{{/if}}>Hobbit</option>
                  <option value="Human" {{#if (eq system.race "Human")}}selected{{/if}}>Human</option>
                </select>
              </div>
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-sex" style="margin-bottom: 2px; text-align: center; font-size: 14px;">Sex</label>
                <select class="char-sex" id="char-sex" name="system.sex" style="width: 70px; height: 2.5em; text-align: center; background-color: white;">
                  <option value="Male" {{#if (eq system.sex "Male")}}selected{{/if}}>Male</option>
                  <option value="Female" {{#if (eq system.sex "Female")}}selected{{/if}}>Female</option>
                  <option value="Other" {{#if (eq system.sex "Other")}}selected{{/if}}>Other</option>
                </select>
              </div>
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-age" style="margin-bottom: 2px; text-align: center; font-size: 14px;">Age</label>
                <input class="char-age" id="char-age" name="system.age" type="text" value="{{system.age}}" style="width: 60px; height: 2.5em; text-align: center; background-color: white;" />
              </div>
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-height" style="margin-bottom: 2px; text-align: center; font-size: 14px;">Height</label>
                <input class="char-height" id="char-height" name="system.height" type="text" value="{{system.height}}" style="width: 70px; height: 2.5em; text-align: center; background-color: white;" />
              </div>
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: center;">
                <label for="char-weight" style="margin-bottom: 2px; text-align: center; font-size: 14px;">Weight</label>
                <input class="char-weight" id="char-weight" name="system.weight" type="text" value="{{system.weight}}" style="width: 70px; height: 2.5em; text-align: center; background-color: white;" />
              </div>
            </div>
          </div>
          
          <!-- Background and Languages Section -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Background & Languages</h3>
            <div style="display: flex; gap: 1rem; flex-wrap: wrap; align-items: flex-start;">
              <!-- Background Field -->
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: flex-start;">
                <label for="char-background" style="margin-bottom: 0.5rem;">Background</label>
                <select class="char-background" id="char-background" name="system.background" style="width: 180px; height: 2.5em; text-align: left; font-size: 14px; padding: 0.25rem; background-color: white;">
                  <option value="" {{#unless system.background}}selected{{/unless}}>-- Select Background --</option>
                  <option value="Actor" {{#if (eq system.background "Actor")}}selected{{/if}}>Actor</option>
                  <option value="Armorer" {{#if (eq system.background "Armorer")}}selected{{/if}}>Armorer</option>
                  <option value="Artisan" {{#if (eq system.background "Artisan")}}selected{{/if}}>Artisan</option>
                  <option value="Baker" {{#if (eq system.background "Baker")}}selected{{/if}}>Baker</option>
                  <option value="Banker" {{#if (eq system.background "Banker")}}selected{{/if}}>Banker</option>
                  <option value="Barber" {{#if (eq system.background "Barber")}}selected{{/if}}>Barber</option>
                  <option value="Barkeep" {{#if (eq system.background "Barkeep")}}selected{{/if}}>Barkeep</option>
                  <option value="Beggar" {{#if (eq system.background "Beggar")}}selected{{/if}}>Beggar</option>
                  <option value="Blacksmith" {{#if (eq system.background "Blacksmith")}}selected{{/if}}>Blacksmith</option>
                  <option value="Bookbinder" {{#if (eq system.background "Bookbinder")}}selected{{/if}}>Bookbinder</option>
                  <option value="Bouncer" {{#if (eq system.background "Bouncer")}}selected{{/if}}>Bouncer</option>
                  <option value="Bowyer" {{#if (eq system.background "Bowyer")}}selected{{/if}}>Bowyer</option>
                  <option value="Brewer" {{#if (eq system.background "Brewer")}}selected{{/if}}>Brewer</option>
                  <option value="Bricklayer" {{#if (eq system.background "Bricklayer")}}selected{{/if}}>Bricklayer</option>
                  <option value="Butcher" {{#if (eq system.background "Butcher")}}selected{{/if}}>Butcher</option>
                  <option value="Caretaker" {{#if (eq system.background "Caretaker")}}selected{{/if}}>Caretaker</option>
                  <option value="Carpenter" {{#if (eq system.background "Carpenter")}}selected{{/if}}>Carpenter</option>
                  <option value="Cartographer" {{#if (eq system.background "Cartographer")}}selected{{/if}}>Cartographer</option>
                  <option value="Charcoal Maker" {{#if (eq system.background "Charcoal Maker")}}selected{{/if}}>Charcoal Maker</option>
                  <option value="Clerk" {{#if (eq system.background "Clerk")}}selected{{/if}}>Clerk</option>
                  <option value="Coachman" {{#if (eq system.background "Coachman")}}selected{{/if}}>Coachman</option>
                  <option value="Cobbler" {{#if (eq system.background "Cobbler")}}selected{{/if}}>Cobbler</option>
                  <option value="Cook" {{#if (eq system.background "Cook")}}selected{{/if}}>Cook</option>
                  <option value="Cooper" {{#if (eq system.background "Cooper")}}selected{{/if}}>Cooper</option>
                  <option value="Courier" {{#if (eq system.background "Courier")}}selected{{/if}}>Courier</option>
                  <option value="Crier" {{#if (eq system.background "Crier")}}selected{{/if}}>Crier</option>
                  <option value="Dairyboy" {{#if (eq system.background "Dairyboy")}}selected{{/if}}>Dairyboy</option>
                  <option value="Distiller" {{#if (eq system.background "Distiller")}}selected{{/if}}>Distiller</option>
                  <option value="Ditch Digger" {{#if (eq system.background "Ditch Digger")}}selected{{/if}}>Ditch Digger</option>
                  <option value="Dyer" {{#if (eq system.background "Dyer")}}selected{{/if}}>Dyer</option>
                  <option value="Engraver" {{#if (eq system.background "Engraver")}}selected{{/if}}>Engraver</option>
                  <option value="Entertainer" {{#if (eq system.background "Entertainer")}}selected{{/if}}>Entertainer</option>
                  <option value="Falconer" {{#if (eq system.background "Falconer")}}selected{{/if}}>Falconer</option>
                  <option value="Farmer" {{#if (eq system.background "Farmer")}}selected{{/if}}>Farmer</option>
                  <option value="Ferrier" {{#if (eq system.background "Ferrier")}}selected{{/if}}>Ferrier</option>
                  <option value="Fishmonger" {{#if (eq system.background "Fishmonger")}}selected{{/if}}>Fishmonger</option>
                  <option value="Fletcher" {{#if (eq system.background "Fletcher")}}selected{{/if}}>Fletcher</option>
                  <option value="Fuller" {{#if (eq system.background "Fuller")}}selected{{/if}}>Fuller</option>
                  <option value="Furrier" {{#if (eq system.background "Furrier")}}selected{{/if}}>Furrier</option>
                  <option value="Gardener" {{#if (eq system.background "Gardener")}}selected{{/if}}>Gardener</option>
                  <option value="Glassblower" {{#if (eq system.background "Glassblower")}}selected{{/if}}>Glassblower</option>
                  <option value="Glazier" {{#if (eq system.background "Glazier")}}selected{{/if}}>Glazier</option>
                  <option value="Glover" {{#if (eq system.background "Glover")}}selected{{/if}}>Glover</option>
                  <option value="Gong Farmer" {{#if (eq system.background "Gong Farmer")}}selected{{/if}}>Gong Farmer</option>
                  <option value="Gravedigger" {{#if (eq system.background "Gravedigger")}}selected{{/if}}>Gravedigger</option>
                  <option value="Groom" {{#if (eq system.background "Groom")}}selected{{/if}}>Groom</option>
                  <option value="Guard" {{#if (eq system.background "Guard")}}selected{{/if}}>Guard</option>
                  <option value="Hatmaker" {{#if (eq system.background "Hatmaker")}}selected{{/if}}>Hatmaker</option>
                  <option value="Herdsman" {{#if (eq system.background "Herdsman")}}selected{{/if}}>Herdsman</option>
                  <option value="Houndsman" {{#if (eq system.background "Houndsman")}}selected{{/if}}>Houndsman</option>
                  <option value="Innkeeper" {{#if (eq system.background "Innkeeper")}}selected{{/if}}>Innkeeper</option>
                  <option value="Jailer" {{#if (eq system.background "Jailer")}}selected{{/if}}>Jailer</option>
                  <option value="Jester" {{#if (eq system.background "Jester")}}selected{{/if}}>Jester</option>
                  <option value="Joiner" {{#if (eq system.background "Joiner")}}selected{{/if}}>Joiner</option>
                  <option value="Juggler" {{#if (eq system.background "Juggler")}}selected{{/if}}>Juggler</option>
                  <option value="Laborer" {{#if (eq system.background "Laborer")}}selected{{/if}}>Laborer</option>
                  <option value="Launderer" {{#if (eq system.background "Launderer")}}selected{{/if}}>Launderer</option>
                  <option value="Lector" {{#if (eq system.background "Lector")}}selected{{/if}}>Lector</option>
                  <option value="Librarian" {{#if (eq system.background "Librarian")}}selected{{/if}}>Librarian</option>
                  <option value="Lumberjack" {{#if (eq system.background "Lumberjack")}}selected{{/if}}>Lumberjack</option>
                  <option value="Maid/Butler" {{#if (eq system.background "Maid/Butler")}}selected{{/if}}>Maid/Butler</option>
                  <option value="Mason" {{#if (eq system.background "Mason")}}selected{{/if}}>Mason</option>
                  <option value="Merchant" {{#if (eq system.background "Merchant")}}selected{{/if}}>Merchant</option>
                  <option value="Messenger" {{#if (eq system.background "Messenger")}}selected{{/if}}>Messenger</option>
                  <option value="Miller" {{#if (eq system.background "Miller")}}selected{{/if}}>Miller</option>
                  <option value="Millwright" {{#if (eq system.background "Millwright")}}selected{{/if}}>Millwright</option>
                  <option value="Mortician" {{#if (eq system.background "Mortician")}}selected{{/if}}>Mortician</option>
                  <option value="Musician" {{#if (eq system.background "Musician")}}selected{{/if}}>Musician</option>
                  <option value="Ne'er-do-well" {{#if (eq system.background "Ne'er-do-well")}}selected{{/if}}>Ne'er-do-well</option>
                  <option value="Page" {{#if (eq system.background "Page")}}selected{{/if}}>Page</option>
                  <option value="Painter" {{#if (eq system.background "Painter")}}selected{{/if}}>Painter</option>
                  <option value="Philosopher" {{#if (eq system.background "Philosopher")}}selected{{/if}}>Philosopher</option>
                  <option value="Porter" {{#if (eq system.background "Porter")}}selected{{/if}}>Porter</option>
                  <option value="Potter" {{#if (eq system.background "Potter")}}selected{{/if}}>Potter</option>
                  <option value="Printer" {{#if (eq system.background "Printer")}}selected{{/if}}>Printer</option>
                  <option value="Prostitute" {{#if (eq system.background "Prostitute")}}selected{{/if}}>Prostitute</option>
                  <option value="Rag & Bone" {{#if (eq system.background "Rag & Bone")}}selected{{/if}}>Rag & Bone</option>
                  <option value="Ratter" {{#if (eq system.background "Ratter")}}selected{{/if}}>Ratter</option>
                  <option value="Runaway Slave" {{#if (eq system.background "Runaway Slave")}}selected{{/if}}>Runaway Slave</option>
                  <option value="Scavenger" {{#if (eq system.background "Scavenger")}}selected{{/if}}>Scavenger</option>
                  <option value="Scholar" {{#if (eq system.background "Scholar")}}selected{{/if}}>Scholar</option>
                  <option value="Serf" {{#if (eq system.background "Serf")}}selected{{/if}}>Serf</option>
                  <option value="Server" {{#if (eq system.background "Server")}}selected{{/if}}>Server</option>
                  <option value="Sexton" {{#if (eq system.background "Sexton")}}selected{{/if}}>Sexton</option>
                  <option value="Squire" {{#if (eq system.background "Squire")}}selected{{/if}}>Squire</option>
                  <option value="Stablehand" {{#if (eq system.background "Stablehand")}}selected{{/if}}>Stablehand</option>
                  <option value="Stonecutter" {{#if (eq system.background "Stonecutter")}}selected{{/if}}>Stonecutter</option>
                  <option value="Street Sweeper" {{#if (eq system.background "Street Sweeper")}}selected{{/if}}>Street Sweeper</option>
                  <option value="Tailor" {{#if (eq system.background "Tailor")}}selected{{/if}}>Tailor</option>
                  <option value="Tallow Chandler" {{#if (eq system.background "Tallow Chandler")}}selected{{/if}}>Tallow Chandler</option>
                  <option value="Tanner" {{#if (eq system.background "Tanner")}}selected{{/if}}>Tanner</option>
                  <option value="Thatcher" {{#if (eq system.background "Thatcher")}}selected{{/if}}>Thatcher</option>
                  <option value="Tobacconist" {{#if (eq system.background "Tobacconist")}}selected{{/if}}>Tobacconist</option>
                  <option value="Trapper" {{#if (eq system.background "Trapper")}}selected{{/if}}>Trapper</option>
                  <option value="Wainwright" {{#if (eq system.background "Wainwright")}}selected{{/if}}>Wainwright</option>
                  <option value="Washer" {{#if (eq system.background "Washer")}}selected{{/if}}>Washer</option>
                  <option value="Weaver" {{#if (eq system.background "Weaver")}}selected{{/if}}>Weaver</option>
                  <option value="Wheelwright" {{#if (eq system.background "Wheelwright")}}selected{{/if}}>Wheelwright</option>
                  <option value="Winemaker" {{#if (eq system.background "Winemaker")}}selected{{/if}}>Winemaker</option>
                  <option value="Woodcutter" {{#if (eq system.background "Woodcutter")}}selected{{/if}}>Woodcutter</option>
                </select>
              </div>
              
              <!-- Languages Field -->
              <div class="char-field-group" style="display: flex; flex-direction: column; align-items: flex-start; min-width: 250px;">
                <div style="display: flex; align-items: center; gap: 6px; margin-bottom: 0.5rem;">
                  <label for="char-languages">Languages</label>
                  <button type="button" class="open-language-dialog" title="Add Language"></button>
                </div>
                <div class="languages-row" style="border: 1px solid #ccc; border-radius: 3px; padding: 0.5rem; min-height: 2.5em; width: 100%; background-color: white;">
                  <div class="languages-tags"></div>
                </div>
                <input type="hidden" name="system.languages" class="char-languages" value="{{system.languages}}" />
              </div>
            </div>
          </div>
          
          <!-- Character Appearance -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Appearance</h3>
            <textarea name="system.bio.appearance" placeholder="Describe your character's physical appearance..." 
                      style="width: 100%; min-height: 80px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white;">{{system.bio.appearance}}</textarea>
          </div>

          <!-- Character Personality -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Personality</h3>
            <textarea name="system.bio.personality" placeholder="Describe your character's personality, traits, and mannerisms..." 
                      style="width: 100%; min-height: 80px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white;">{{system.bio.personality}}</textarea>
          </div>

          <!-- Character Background/History -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Background & History</h3>
            <textarea name="system.bio.history" placeholder="Tell your character's story, background, and important life events..." 
                      style="width: 100%; min-height: 120px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white;">{{system.bio.history}}</textarea>
          </div>

          <!-- Character Goals & Motivations -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Goals & Motivations</h3>
            <textarea name="system.bio.goals" placeholder="What drives your character? What are their goals and motivations..." 
                      style="width: 100%; min-height: 80px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white;">{{system.bio.goals}}</textarea>
          </div>

          <!-- Additional Notes -->
          <div class="bio-section">
            <h3 style="margin: 0 0 0.5rem 0; padding-bottom: 0.25rem; border-bottom: 1px solid #ccc; font-size: 1.1em;">Additional Notes</h3>
            <textarea name="system.bio.notes" placeholder="Any additional notes, relationships, or important details..." 
                      style="width: 100%; min-height: 100px; padding: 0.5rem; border: 1px solid #ccc; border-radius: 3px; resize: vertical; font-family: inherit; background-color: white;">{{system.bio.notes}}</textarea>
          </div>

        </div>
      </div>
    </section>
</form>